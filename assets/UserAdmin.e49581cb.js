import{Q as N,d as $}from"./QTable.467684ee.js";import{aR as j,r as v,s as x,t as g,v as y,x as d,d as l,D as w,aW as h,Q as u,y as n,F as D,aX as i,aM as V}from"./index.de8cf485.js";import{Q as m}from"./QInput.db6556ad.js";import{Q as r}from"./QCardSection.936b2c95.js";import{Q as F,C as b}from"./ClosePopup.56db0ccc.js";import{Q as P}from"./QCard.5ac78a81.js";import"./use-key-composition.09f48e6b.js";import"./QCheckbox.ba2b73e8.js";const E={class:"q-pa-md text-center"},I={class:"q-pa-md text-center column row-xs justify-center"},M={key:0,class:"q-pa-md text-center column row-xs"},O={key:1,class:"q-pa-md text-center column row-xs justify-center"},R={class:"row justify-center"},S=d("div",{class:"text-h6"},"id",-1),T=d("div",{class:"text-h6"},"\u540D\u5B57",-1),W=d("div",{class:"text-h6"},"\u5E33\u865F",-1),X=d("div",{class:"text-h6"},"\u624B\u6A5F",-1),z=d("div",{class:"text-h6"},"\u6B0A\u9650:\u7BA1\u7406\u54E1:1 \u4F7F\u7528\u8005:0",-1),le={__name:"UserAdmin",setup(G){const c=j(),t=v([]),f=v(!1),C=[{name:"id",required:!0,label:"id",align:"left",field:a=>a.id,format:a=>`${a}`,sortable:!0},{name:"account",align:"left",label:"account",field:"account",sortable:!0},{name:"name",align:"left",label:"name",field:"name",sortable:!0},{name:"phone",align:"left",label:"phone",field:"phone",sortable:!0},{name:"role",align:"left",label:"role",field:"role",sortable:!0}];function q(){f.value=!0}const o=x([]),_=async()=>{const a=await i.get("/users/all");o.splice(0,o.length);let e=0;for(e=0;e<a.data.result.data.length;e++)o.push({id:a.data.result.data[e]._id,account:a.data.result.data[e].account,name:a.data.result.data[e].name,phone:a.data.result.data[e].phone,role:a.data.result.data[e].role});c.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u6703\u54E1\u53D6\u5F97\u6210\u529F"})};_();const p=x({search:""}),k=async()=>{try{const a=await i.post("users/search/name",p);o.splice(0,o.length),console.log(a.data.message);let e=0;for(e=0;e<=a.data.message.length;e++)o.push({id:a.data.message[e]._id,account:a.data.message[e].account,name:a.data.message[e].name,phone:a.data.message[e].phone,role:a.data.message[e].role}),c.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u641C\u5C0B\u6210\u529F"})}catch(a){console.log(a)}},Q=async()=>{try{const a=await i.post("users/search/account",p);o.splice(0,o.length),console.log(a.data.message);let e=0;for(e=0;e<=a.data.message.length;e++)o.push({id:a.data.message[e]._id,account:a.data.message[e].account,name:a.data.message[e].name,phone:a.data.message[e].phone,role:a.data.message[e].role}),c.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u641C\u5C0B\u6210\u529F"})}catch(a){console.log(a)}},U=async()=>{try{const a=await i.post("users/search/phone",p);o.splice(0,o.length),console.log(a.data.message);let e=0;for(e=0;e<=a.data.message.length;e++)o.push({id:a.data.message[e]._id,account:a.data.message[e].account,name:a.data.message[e].name,phone:a.data.message[e].phone,role:a.data.message[e].role}),c.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u641C\u5C0B\u6210\u529F"})}catch(a){console.log(a)}},A=async()=>{try{const a=await i.delete(`/users/${t.value[0].id}`);for(console.log(a),c.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u522A\u9664\u6210\u529F"});o.length;)o.pop();_()}catch{c.notify({color:"red-4",textColor:"white",icon:"cloud_done",message:"\u522A\u9664\u5931\u6557"})}},B=async()=>{try{console.log(t==null?void 0:t.value[0]),await i.patch(`/users/${t==null?void 0:t.value[0].id}`,t.value[0]),await c.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u4FEE\u6539\u6210\u529F"})}catch(a){c.notify({color:"red-4",textColor:"white",icon:"info",message:a.message})}};return(a,e)=>(g(),y(D,null,[d("section",null,[d("div",E,[l(N,{title:"\u6703\u54E1\u7BA1\u7406",rows:o,columns:C,"row-key":"name",selection:"single",selected:t.value,"onUpdate:selected":e[0]||(e[0]=s=>t.value=s)},null,8,["rows","selected"])]),d("div",I,[t.value[0]?(g(),w(u,{key:0,icon:"edit",label:"\u4FEE\u6539",onClick:q,class:"q-ma-xl",color:"teal"})):h("",!0),t.value[0]?(g(),w(u,{key:1,icon:"delete",label:"\u522A\u9664",onClick:A,class:"q-ma-xl",color:"teal"})):h("",!0)]),t.value[0]?h("",!0):(g(),y("div",M,[l(m,{outlined:"",modelValue:p.search,"onUpdate:modelValue":e[1]||(e[1]=s=>p.search=s),label:"\u641C\u5C0B","stack-label":"",style:{margin:"auto",width:"400px","margin-bottom":"32px"}},null,8,["modelValue"])])),t.value[0]?h("",!0):(g(),y("div",O,[l(u,{icon:"search",label:"\u540D\u5B57",onClick:k,class:"q-mr-md-xl q-my-md",color:"primary"}),l(u,{icon:"search",label:"\u5E33\u865F",onClick:Q,class:"q-mr-md-xl q-my-md",color:"primary"}),l(u,{icon:"search",label:"\u96FB\u8A71",onClick:U,class:"q-my-md",color:"primary"})])),d("div",R,[l(u,{icon:"reply",label:"\u8FD4\u56DE",class:"q-mt-xl",onClick:_,color:"teal"})])]),l($,{modelValue:f.value,"onUpdate:modelValue":e[7]||(e[7]=s=>f.value=s),persistent:""},{default:n(()=>[l(P,{style:{width:"400px"}},{default:n(()=>[l(r,null,{default:n(()=>[S]),_:1}),l(r,{class:"q-pt-none"},{default:n(()=>[l(m,{outline:"",modelValue:t.value[0].id,"onUpdate:modelValue":e[2]||(e[2]=s=>t.value[0].id=s),readonly:""},null,8,["modelValue"])]),_:1}),l(r,null,{default:n(()=>[T]),_:1}),l(r,{class:"q-pt-none"},{default:n(()=>[l(m,{outline:"",modelValue:t.value[0].name,"onUpdate:modelValue":e[3]||(e[3]=s=>t.value[0].name=s)},null,8,["modelValue"])]),_:1}),l(r,null,{default:n(()=>[W]),_:1}),l(r,{class:"q-pt-none"},{default:n(()=>[l(m,{outline:"",modelValue:t.value[0].account,"onUpdate:modelValue":e[4]||(e[4]=s=>t.value[0].account=s)},null,8,["modelValue"])]),_:1}),l(r,null,{default:n(()=>[X]),_:1}),l(r,{class:"q-pt-none"},{default:n(()=>[l(m,{outline:"",modelValue:t.value[0].phone,"onUpdate:modelValue":e[5]||(e[5]=s=>t.value[0].phone=s)},null,8,["modelValue"])]),_:1}),l(r,null,{default:n(()=>[z]),_:1}),l(r,{class:"q-pt-none"},{default:n(()=>[l(m,{outline:"",modelValue:t.value[0].role,"onUpdate:modelValue":e[6]||(e[6]=s=>t.value[0].role=s)},null,8,["modelValue"])]),_:1}),l(F,{align:"right",class:"text-primary"},{default:n(()=>[V(l(u,{flat:"",label:"\u53D6\u6D88"},null,512),[[b]]),V(l(u,{flat:"",label:"\u66F4\u6539",onClick:B},null,512),[[b]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{le as default};
