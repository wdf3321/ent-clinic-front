import{Q as E}from"./QTable.a1535b4d.js";import{r as C,aR as F,s as h,t as Q,v as R,x as s,f as e,Q as r,aN as m,D as q,E as U,y as l,F as T,aW as b,M as v,b4 as D}from"./index.6832796b.js";import{Q as d}from"./QCardSection.e3f9bfb4.js";import{Q as V,a as k}from"./QPopupProxy.2780de9c.js";import{Q as p}from"./QInput.4a30f91e.js";import{Q as $}from"./QTime.abf6fa6f.js";import{Q as j}from"./QCardActions.f876626c.js";import{Q as B}from"./QCard.439859a5.js";import{b as N}from"./QSelect.f9e87b1a.js";import{C as c}from"./ClosePopup.435e6220.js";import{u as W}from"./vue-i18n.runtime.esm-bundler.22815b5c.js";import"./QCheckbox.fa88a2cd.js";import"./use-key-composition.4fb6c708.js";import"./use-cache.b0833c75.js";const L={class:"q-pa-md"},M={class:"text-center",id:"btns"},z=s("div",{class:"text-h6"},"\u65E5\u671F",-1),G={class:"row items-center justify-end"},H=s("div",{class:"text-h6"},"\u6642\u9593",-1),J={class:"row items-center justify-end"},O=s("div",{class:"text-h6"},"\u4EBA\u6578",-1),X=s("div",{class:"text-h6"},"\u958B\u59CB\u65E5\u671F",-1),Y={class:"row items-center justify-end"},Z=s("div",{class:"text-h6"},"\u7D50\u675F\u65E5\u671F",-1),ee={class:"row items-center justify-end"},te=s("div",{class:"text-h6"},"\u4EBA\u6578",-1),le=s("div",{class:"text-h6"},"\u6642\u9593",-1),oe={class:"row items-center justify-end"},Ve={__name:"LimitAdmin",setup(ae){const{t:x}=W(),w=C(!1),g=C(!1),f=F(),i=h({date:"",time:"",member:""}),n=h({startDate:"",endDate:"",time:"",member:""}),u=h([]),_=C([]),y=async()=>{const a=await b.get("/reserve");console.log(a.data.result);let t=0;for(t=0;t<a.data.result.length;t++)a.data.result[t].member!==0&&u.push({date:a.data.result[t].date,time:a.data.result[t].time,member:a.data.result[t].member,id:a.data.result[t]._id});f.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u53EF\u9810\u7D04\u53D6\u5F97\u6210\u529F"})};y();const S=async()=>{const a=await b.post("/reserve/",i);for(console.log(a),f.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u65B0\u589E\u6210\u529F"});u.length;)u.pop();y()},A=async()=>{try{const a=await b.post("/reserve/week",n);for(console.log(a),f.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u65B0\u589E\u6210\u529F"});u.length;)u.pop();y()}catch{f.notify({color:"red-4",textColor:"white",icon:"cloud_done",message:"\u65B0\u589E\u6210\u529F"})}},I=async()=>{try{const a=await b.delete(`/reserve/${_.value[0].id}`);for(console.log(a),f.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u522A\u9664\u6210\u529F"});u.length;)u.pop();y()}catch{f.notify({color:"red-4",textColor:"white",icon:"cloud_off",message:"\u8ACB\u9078\u64C7\u8981\u522A\u9664\u7684\u9805\u76EE"})}},K=async()=>{try{const a=await b.delete("/reserve/delete/all");console.log(a),u.splice(0,u.length),f.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u522A\u9664\u6210\u529F"}),y()}catch{f.notify({color:"red-4",textColor:"white",icon:"cloud_done",message:"\u522A\u9664\u5931\u6557"})}},P=[{name:"id",align:"center",label:"id",field:"id",sortable:!0},{name:"date",required:!0,label:x("date"),align:"left",field:a=>a.date,format:a=>`${a}`,sortable:!0},{name:"time",align:"center",label:x("time"),field:"time",sortable:!0},{name:"member",label:x("limit"),field:"member",sortable:!0}];return(a,t)=>(Q(),R(T,null,[s("section",null,[s("div",L,[e(E,{title:a.$t("limitadmin"),rows:u,columns:P,"row-key":"id",selection:"single",selected:_.value,"onUpdate:selected":t[0]||(t[0]=o=>_.value=o)},null,8,["title","rows","selected"])])]),s("section",null,[s("div",M,[e(r,{icon:"add",label:"\u65B0\u589E\u4E00\u5929",color:"primary",onClick:t[1]||(t[1]=o=>w.value=!0),class:"q-mr-md-xl q-my-xs-xs"}),e(r,{icon:"add_box",label:"\u65B0\u589E\u591A\u5929",color:"primary",onClick:t[2]||(t[2]=o=>g.value=!0),class:"q-mr-md-xl q-my-xs-xs"}),_.value[0]?m((Q(),q(r,{key:0,color:"teal",label:"\u522A\u9664\u9078\u64C7",icon:"delete",onClick:I,class:"q-mr-md-xl q-my-xs-xs"},null,512)),[[c]]):U("",!0),_.value[0]?U("",!0):(Q(),q(r,{key:1,icon:"delete",color:"teal",label:"\u4E00\u9375\u5168\u522A",onClick:K}))])]),e(N,{modelValue:w.value,"onUpdate:modelValue":t[9]||(t[9]=o=>w.value=o),persistent:""},{default:l(()=>[e(B,{style:{"min-width":"400px"}},{default:l(()=>[e(d,null,{default:l(()=>[z]),_:1}),e(d,{class:"q-pt-none"},{default:l(()=>[e(p,{filled:"",modelValue:i.date,"onUpdate:modelValue":t[4]||(t[4]=o=>i.date=o),mask:"date",rules:["date"]},{append:l(()=>[e(v,{name:"calendar_today",class:"cursor-pointer"},{default:l(()=>[e(V,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(k,{modelValue:i.date,"onUpdate:modelValue":t[3]||(t[3]=o=>i.date=o),"today-btn":""},{default:l(()=>[s("div",G,[m(e(r,{label:"Close",color:"primary",flat:""},null,512),[[c]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(d,null,{default:l(()=>[H]),_:1}),e(d,{class:"q-pt-none"},{default:l(()=>[e(p,{filled:"",modelValue:i.time,"onUpdate:modelValue":t[6]||(t[6]=o=>i.time=o),mask:"time",rules:["time"]},{append:l(()=>[e(v,{name:"access_time",class:"cursor-pointer"},{default:l(()=>[e(V,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e($,{modelValue:i.time,"onUpdate:modelValue":t[5]||(t[5]=o=>i.time=o),"now-btn":""},{default:l(()=>[s("div",J,[m(e(r,{label:"Close",color:"primary",flat:""},null,512),[[c]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(d,null,{default:l(()=>[O]),_:1}),e(d,{class:"q-pt-none"},{default:l(()=>[e(p,{dense:"",modelValue:i.member,"onUpdate:modelValue":t[7]||(t[7]=o=>i.member=o),autofocus:"",onKeyup:t[8]||(t[8]=D(o=>w.value=!1,["enter"]))},null,8,["modelValue"])]),_:1}),e(j,{align:"right",class:"text-white"},{default:l(()=>[m(e(r,{flat:"",color:"secondary",label:"\u53D6\u6D88"},null,512),[[c]]),m(e(r,{color:"teal",label:"\u65B0\u589E",onClick:S},null,512),[[c]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(N,{modelValue:g.value,"onUpdate:modelValue":t[18]||(t[18]=o=>g.value=o),persistent:""},{default:l(()=>[e(B,{style:{"min-width":"400px"}},{default:l(()=>[e(d,null,{default:l(()=>[X]),_:1}),e(d,{class:"q-pt-none"},{default:l(()=>[e(p,{filled:"",modelValue:n.startDate,"onUpdate:modelValue":t[11]||(t[11]=o=>n.startDate=o),mask:"date",rules:["date"]},{append:l(()=>[e(v,{name:"calendar_today",class:"cursor-pointer"},{default:l(()=>[e(V,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(k,{modelValue:n.startDate,"onUpdate:modelValue":t[10]||(t[10]=o=>n.startDate=o),"today-btn":""},{default:l(()=>[s("div",Y,[m(e(r,{label:"Close",color:"primary",flat:""},null,512),[[c]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(d,null,{default:l(()=>[Z]),_:1}),e(d,{class:"q-pt-none"},{default:l(()=>[e(p,{filled:"",modelValue:n.endDate,"onUpdate:modelValue":t[13]||(t[13]=o=>n.endDate=o),mask:"date",rules:["date"]},{append:l(()=>[e(v,{name:"calendar_today",class:"cursor-pointer"},{default:l(()=>[e(V,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(k,{modelValue:n.endDate,"onUpdate:modelValue":t[12]||(t[12]=o=>n.endDate=o),"today-btn":""},{default:l(()=>[s("div",ee,[m(e(r,{label:"Close",color:"primary",flat:""},null,512),[[c]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(d,null,{default:l(()=>[te]),_:1}),e(d,{class:"q-pt-none"},{default:l(()=>[e(p,{dense:"",modelValue:n.member,"onUpdate:modelValue":t[14]||(t[14]=o=>n.member=o),autofocus:"",onKeyup:t[15]||(t[15]=D(o=>g.value=!1,["enter"]))},null,8,["modelValue"])]),_:1}),e(d,null,{default:l(()=>[le]),_:1}),e(d,{class:"q-pt-none"},{default:l(()=>[e(p,{filled:"",modelValue:n.time,"onUpdate:modelValue":t[17]||(t[17]=o=>n.time=o),mask:"time",rules:["time"]},{append:l(()=>[e(v,{name:"access_time",class:"cursor-pointer"},{default:l(()=>[e(V,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e($,{modelValue:n.time,"onUpdate:modelValue":t[16]||(t[16]=o=>n.time=o),"now-btn":""},{default:l(()=>[s("div",oe,[m(e(r,{label:"Close",color:"primary",flat:""},null,512),[[c]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(j,{align:"right",class:"text-white"},{default:l(()=>[m(e(r,{flat:"",color:"secondary",label:"\u53D6\u6D88"},null,512),[[c]]),m(e(r,{color:"teal",label:"\u65B0\u589E",onClick:A},null,512),[[c]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{Ve as default};
