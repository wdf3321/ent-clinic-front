import{Q as F}from"./QImg.82d36c25.js";import{Q as $}from"./QTd.0fd78eae.js";import{Q as N,d as j,e as D}from"./QTable.da1cfe8f.js";import{aR as I,r as y,s as w,t as f,v as x,x as i,f as l,y as n,D as V,aW as h,Q as c,F as S,aX as m,aM as b}from"./index.259f3f0b.js";import{Q as p}from"./QInput.f73e3455.js";import{Q as d}from"./QCardSection.82343ad3.js";import{Q as T}from"./QCardActions.c3f46b4f.js";import{Q as E}from"./QCard.e6910790.js";import{C}from"./ClosePopup.2e0ec6a6.js";import{u as M}from"./vue-i18n.runtime.esm-bundler.0f884c19.js";import"./use-key-composition.f7cc742c.js";import"./QCheckbox.bda9ead0.js";const O={class:"q-pa-md text-center"},P={class:"q-pa-md text-center column row-xs justify-center"},R={key:0,class:"q-pa-md text-center column row-xs"},W={key:1,class:"q-pa-md text-center column row-xs justify-center"},X={class:"row justify-center"},z=i("div",{class:"text-h6"},"id",-1),G=i("div",{class:"text-h6"},"\u540D\u5B57",-1),H=i("div",{class:"text-h6"},"\u5E33\u865F",-1),J=i("div",{class:"text-h6"},"\u624B\u6A5F",-1),K=i("div",{class:"text-h6"},"\u6B0A\u9650:\u7BA1\u7406\u54E1:1 \u4F7F\u7528\u8005:0",-1),ue={__name:"UserAdmin",setup(L){const{t:g}=M(),u=I(),t=y([]),Q=["\u540D\u5B57","\u5E33\u865F","\u96FB\u8A71"],_=y(!1),q=[{name:"image",label:g("image"),align:"left"},{name:"id",required:!0,label:"id",align:"left",field:"id",sortable:!0},{name:"account",align:"left",label:g("account"),field:"account",sortable:!0},{name:"name",align:"left",label:g("name"),field:"name",sortable:!0},{name:"phone",align:"left",label:g("phone"),field:"phone",sortable:!0},{name:"role",align:"left",label:g("role"),field:"role",sortable:!0}];function k(){_.value=!0}const s=w([]),v=async()=>{const o=await m.get("/users/all");s.splice(0,s.length);let e=0;for(e=0;e<o.data.result.data.length;e++)s.push({id:o.data.result.data[e]._id,account:o.data.result.data[e].account,name:o.data.result.data[e].name,phone:o.data.result.data[e].phone,role:o.data.result.data[e].role});u.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u6703\u54E1\u53D6\u5F97\u6210\u529F"})};v();const r=w({search:"",select:""}),U=async()=>{var o;try{if(console.log(r),r.select==="\u540D\u5B57"){const e=await m.post("users/search/name",r);s.splice(0,s.length);let a=0;for(a=0;a<=e.data.message.length;a++)s.push({id:e.data.message[a]._id,account:e.data.message[a].account,name:e.data.message[a].name,phone:e.data.message[a].phone,role:e.data.message[a].role});u.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u641C\u5C0B\u6210\u529F"})}else if(r.select==="\u5E33\u865F"){const e=await m.post("users/search/account",r);s.splice(0,s.length);let a=0;for(a=0;a<=e.data.message.length;a++)s.push({id:e.data.message[a]._id,account:e.data.message[a].account,name:e.data.message[a].name,phone:e.data.message[a].phone,role:e.data.message[a].role});u.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u641C\u5C0B\u6210\u529F"})}else if(r.select==="\u96FB\u8A71"){const e=await m.post("users/search/phone",r);s.splice(0,s.length),console.log(e.data.message);let a=0;for(a=0;a<=e.data.message.length;a++)s.push({id:(o=e.data.message[a])==null?void 0:o._id,account:e.data.message[a].account,name:e.data.message[a].name,phone:e.data.message[a].phone,role:e.data.message[a].role})}u.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u641C\u5C0B\u6210\u529F"})}catch(e){console.log(e)}},A=async()=>{try{const o=await m.delete(`/users/${t.value[0].id}`);for(console.log(o),u.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u522A\u9664\u6210\u529F"});s.length;)s.pop();v()}catch{u.notify({color:"red-4",textColor:"white",icon:"cloud_done",message:"\u522A\u9664\u5931\u6557"})}},B=async()=>{try{console.log(t==null?void 0:t.value[0]),await m.patch(`/users/admin/${t==null?void 0:t.value[0].id}`,t.value[0]),await u.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u4FEE\u6539\u6210\u529F"})}catch(o){u.notify({color:"red-4",textColor:"white",icon:"info",message:o.message})}};return(o,e)=>(f(),x(S,null,[i("section",null,[i("div",O,[l(N,{title:o.$t("useradmin"),rows:s,columns:q,"row-key":"name",selection:"single",selected:t.value,"onUpdate:selected":e[0]||(e[0]=a=>t.value=a)},{"body-cell-image":n(a=>[l($,{style:{width:"10px"}},{default:n(()=>[l(F,{src:`https://source.boringavatars.com/beam/${a.row.account}?colors=53C2BA,C0538A,F4C752,060614,F5F5F4`,height:"70px",width:"70px"},null,8,["src"])]),_:2},1024)]),_:1},8,["title","rows","selected"])]),i("div",P,[t.value[0]?(f(),V(c,{key:0,icon:"edit",label:"\u4FEE\u6539",onClick:k,class:"q-ma-xl",color:"teal"})):h("",!0),t.value[0]?(f(),V(c,{key:1,icon:"delete",label:"\u522A\u9664",onClick:A,class:"q-ma-xl",color:"teal"})):h("",!0)]),t.value[0]?h("",!0):(f(),x("div",R,[l(p,{outlined:"",modelValue:r.search,"onUpdate:modelValue":e[1]||(e[1]=a=>r.search=a),label:"\u641C\u5C0B","stack-label":"",style:{margin:"auto",width:"400px","margin-bottom":"32px"}},null,8,["modelValue"])])),t.value[0]?h("",!0):(f(),x("div",W,[l(c,{icon:"search",label:"\u641C\u5C0B",onClick:U,class:"q-mr-md-xl q-my-md",color:"primary"}),l(j,{outlined:"",modelValue:r.select,"onUpdate:modelValue":e[2]||(e[2]=a=>r.select=a),options:Q,label:"\u641C\u5C0B\u985E\u5225",id:"option"},null,8,["modelValue"])])),i("div",X,[l(c,{icon:"reply",label:"\u8FD4\u56DE",class:"q-mt-xl",onClick:v,color:"teal"})])]),l(D,{modelValue:_.value,"onUpdate:modelValue":e[8]||(e[8]=a=>_.value=a),persistent:""},{default:n(()=>[l(E,{style:{width:"400px"}},{default:n(()=>[l(d,null,{default:n(()=>[z]),_:1}),l(d,{class:"q-pt-none"},{default:n(()=>[l(p,{outline:"",modelValue:t.value[0].id,"onUpdate:modelValue":e[3]||(e[3]=a=>t.value[0].id=a),readonly:""},null,8,["modelValue"])]),_:1}),l(d,null,{default:n(()=>[G]),_:1}),l(d,{class:"q-pt-none"},{default:n(()=>[l(p,{outline:"",modelValue:t.value[0].name,"onUpdate:modelValue":e[4]||(e[4]=a=>t.value[0].name=a)},null,8,["modelValue"])]),_:1}),l(d,null,{default:n(()=>[H]),_:1}),l(d,{class:"q-pt-none"},{default:n(()=>[l(p,{outline:"",modelValue:t.value[0].account,"onUpdate:modelValue":e[5]||(e[5]=a=>t.value[0].account=a)},null,8,["modelValue"])]),_:1}),l(d,null,{default:n(()=>[J]),_:1}),l(d,{class:"q-pt-none"},{default:n(()=>[l(p,{outline:"",modelValue:t.value[0].phone,"onUpdate:modelValue":e[6]||(e[6]=a=>t.value[0].phone=a)},null,8,["modelValue"])]),_:1}),l(d,null,{default:n(()=>[K]),_:1}),l(d,{class:"q-pt-none"},{default:n(()=>[l(p,{outline:"",modelValue:t.value[0].role,"onUpdate:modelValue":e[7]||(e[7]=a=>t.value[0].role=a)},null,8,["modelValue"])]),_:1}),l(T,{align:"right",class:"text-primary"},{default:n(()=>[b(l(c,{flat:"",label:"\u53D6\u6D88"},null,512),[[C]]),b(l(c,{flat:"",label:"\u66F4\u6539",onClick:B},null,512),[[C]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{ue as default};
