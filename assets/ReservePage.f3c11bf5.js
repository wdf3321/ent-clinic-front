import{Q as M,e as N}from"./QTable.fb4f1674.js";import{Q as m}from"./QCardSection.a195a02e.js";import{Q as b}from"./QInput.597a13a7.js";import{aU as E,v as I,r as y,x as w,w as P,y as B,z as Q,A as c,f as o,B as r,I as V,aS as C,H as R,F as $,aY as T,E as z,aQ as H,Q as k}from"./index.738b47e8.js";import{Q as O,C as W}from"./ClosePopup.7711fcb6.js";import{Q as j}from"./QCard.ceefab55.js";import{h as n}from"./moment.9709ab41.js";import"./use-key-composition.c88f08c3.js";import"./QCheckbox.afa17b8d.js";const G={class:"q-pa-md text-center"},J={class:"q-pa-md text-center"},K=c("h4",{class:""},"\u6211\u8981\u9810\u7D04",-1),L=c("div",{class:"text-h6"},"\u65E5\u671F",-1),X=c("div",{class:"text-h6"},"\u6642\u9593",-1),Z=c("div",{class:"text-h6"},"\u59D3\u540D",-1),ee=c("div",{class:"text-h6"},"\u4EBA\u6578",-1),te=c("div",{class:"text-h6"},"\u624B\u6A5F",-1),le={key:0,class:"text-h6"},ae={key:1,class:"text-h6"},pe={__name:"ReservePage",setup(se){const q=E(),x=I(),_=y(!1),h=y(!1),f=y([]),U=w([]),D=w([]),t=y(""),S=async()=>{const a=await T.get("/reserve");let l=0;for(l=0;l<a.data.result.length;l++)if(console.log(),!(a.data.result[l].member<=0)){{if(n(a.data.result[l].date).isBefore(n().format("YYYY/MM/DD")))continue;g.push({date:a.data.result[l].date,time:a.data.result[l].time,member:a.data.result[l].member,id:a.data.result[l]._id})}U.includes(a.data.result[l].date)||U.push(a.data.result[l].date),D.includes(a.data.result[l].time)||D.push(a.data.result[l].time)}x.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u53D6\u5F97\u6210\u529F"})};S();const Y=()=>{u.time=f.value[0].time,u.date=f.value[0].date,u.phone=q.phone,u.name=q.name,_.value=!0},u=w({name:"",member:"",time:"",date:"",phone:""}),A=async()=>{try{console.log(u);const a=await T.post("/reserve/make",u);for(console.log(a),x.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u6210\u529F"}),_.value=!1;g.length;)g.pop();S()}catch{x.notify({color:"red-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u5931\u6557\uFF0C\u8ACB\u9078\u64C7\u5176\u4ED6\u6642\u9593"})}},F=[{name:"date",required:!0,label:"\u65E5\u671F",align:"center",field:a=>a.date,format:a=>`${a}`,sortable:!0},{name:"time",align:"center",label:"\u6642\u9593",field:"time",sortable:!0},{name:"member",align:"center",label:"\u5269\u9918",field:"member",sortable:!0}],g=w([]),e=w([]);return(async()=>{const a=await z.get("/doctors");console.log(a.data.result);let l=0;for(l=0;l<a.data.result.length;l++)e.push({time:a.data.result[l].time,mon:a.data.result[l].mon,tue:a.data.result[l].tue,wed:a.data.result[l].wed,thur:a.data.result[l].thur,fri:a.data.result[l].fri,sat:a.data.result[l].sat,sun:a.data.result[l].sun});console.log(e[0].mon)})(),P(f,(a,l)=>{const s="hh:mm:ss",i=n(a[0].time,s),v=n("08:30:00",s),d=n("15:00:00",s),p=n("18:00:00",s);console.log(n(a[0].date).format("dddd")),n(a[0].date).format("dddd")==="Monday"?i.isBetween(v,d)===!0?e[0].mon==="a"?t.value="\u738B\u91AB\u5E2B":e[0].mon==="b"?t.value="\u5F35\u91AB\u5E2B":e[0].mon==="c"&&(t.value="\u674E\u91AB\u5E2B"):i.isBetween(d,p)===!0?e[1].mon==="a"?t.value="\u738B\u91AB\u5E2B":e[1].mon==="b"?t.value="\u5F35\u91AB\u5E2B":e[1].mon==="c"&&(t.value="\u674E\u91AB\u5E2B"):e[2].mon==="a"?t.value="\u738B\u91AB\u5E2B":e[2].mon==="b"?t.value="\u5F35\u91AB\u5E2B":e[2].mon==="c"&&(t.value="\u674E\u91AB\u5E2B"):n(a[0].date).format("dddd")==="Tuesday"?i.isBetween(v,d)===!0?e[0].tue==="a"?t.value="\u738B\u91AB\u5E2B":e[0].tue==="b"?t.value="\u5F35\u91AB\u5E2B":e[0].tue==="c"&&(t.value="\u674E\u91AB\u5E2B"):i.isBetween(d,p)===!0?e[1].tue==="a"?t.value="\u738B\u91AB\u5E2B":e[1].tue==="b"?t.value="\u5F35\u91AB\u5E2B":e[1].tue==="c"&&(t.value="\u674E\u91AB\u5E2B"):e[2].tue==="a"?t.value="\u738B\u91AB\u5E2B":e[2].tue==="b"?t.value="\u5F35\u91AB\u5E2B":e[2].tue==="c"&&(t.value="\u674E\u91AB\u5E2B"):n(a[0].date).format("dddd")==="Wednesday"?i.isBetween(v,d)===!0?e[0].wed==="a"?t.value="\u738B\u91AB\u5E2B":e[0].wed==="b"?t.value="\u5F35\u91AB\u5E2B":e[0].wed==="c"&&(t.value="\u674E\u91AB\u5E2B"):i.isBetween(d,p)===!0?e[1].wed==="a"?t.value="\u738B\u91AB\u5E2B":e[1].wed==="b"?t.value="\u5F35\u91AB\u5E2B":e[1].wed==="c"&&(t.value="\u674E\u91AB\u5E2B"):e[2].wed==="a"?t.value="\u738B\u91AB\u5E2B":e[2].wed==="b"?t.value="\u5F35\u91AB\u5E2B":e[2].wed==="c"&&(t.value="\u674E\u91AB\u5E2B"):n(a[0].date).format("dddd")==="Thursday"?i.isBetween(v,d)===!0?e[0].thur==="a"?t.value="\u738B\u91AB\u5E2B":e[0].thur==="b"?t.value="\u5F35\u91AB\u5E2B":e[0].thur==="c"&&(t.value="\u674E\u91AB\u5E2B"):i.isBetween(d,p)===!0?e[1].thur==="a"?t.value="\u738B\u91AB\u5E2B":e[1].thur==="b"?t.value="\u5F35\u91AB\u5E2B":e[1].thur==="c"&&(t.value="\u674E\u91AB\u5E2B"):e[2].thur==="a"?t.value="\u738B\u91AB\u5E2B":e[2].thur==="b"?t.value="\u5F35\u91AB\u5E2B":e[2].thur==="c"&&(t.value="\u674E\u91AB\u5E2B"):n(a[0].date).format("dddd")==="Friday"?i.isBetween(v,d)===!0?e[0].fri==="a"?t.value="\u738B\u91AB\u5E2B":e[0].fri==="b"?t.value="\u5F35\u91AB\u5E2B":e[0].fri==="c"&&(t.value="\u674E\u91AB\u5E2B"):i.isBetween(d,p)===!0?e[1].fri==="a"?t.value="\u738B\u91AB\u5E2B":e[1].fri==="b"?t.value="\u5F35\u91AB\u5E2B":e[1].fri==="c"&&(t.value="\u674E\u91AB\u5E2B"):e[2].fri==="a"?t.value="\u738B\u91AB\u5E2B":e[2].fri==="b"?t.value="\u5F35\u91AB\u5E2B":e[2].fri==="c"&&(t.value="\u674E\u91AB\u5E2B"):n(a[0].date).format("dddd")==="Saturday"?i.isBetween(v,d)===!0?e[0].sat==="a"?t.value="\u738B\u91AB\u5E2B":e[0].sat==="b"?t.value="\u5F35\u91AB\u5E2B":e[0].sat==="c"&&(t.value="\u674E\u91AB\u5E2B"):i.isBetween(d,p)===!0?e[1].sat==="a"?t.value="\u738B\u91AB\u5E2B":e[1].sat==="b"?t.value="\u5F35\u91AB\u5E2B":e[1].sat==="c"&&(t.value="\u674E\u91AB\u5E2B"):e[2].sat==="a"?t.value="\u738B\u91AB\u5E2B":e[2].sat==="b"?t.value="\u5F35\u91AB\u5E2B":e[2].sat==="c"&&(t.value="\u674E\u91AB\u5E2B"):n(a[0].date).format("dddd")==="Sunday"&&(i.isBetween(v,d)===!0?e[0].sun==="a"?t.value="\u738B\u91AB\u5E2B":e[0].sun==="b"?t.value="\u5F35\u91AB\u5E2B":e[0].sun==="c"&&(t.value="\u674E\u91AB\u5E2B"):i.isBetween(d,p)===!0?e[1].sun==="a"?t.value="\u738B\u91AB\u5E2B":e[1].sun==="b"?t.value="\u5F35\u91AB\u5E2B":e[1].sun==="c"&&(t.value="\u674E\u91AB\u5E2B"):e[2].sun==="a"?t.value="\u738B\u91AB\u5E2B":e[2].sun==="b"?t.value="\u5F35\u91AB\u5E2B":e[2].sun==="c"&&(t.value="\u674E\u91AB\u5E2B"))}),(a,l)=>(B(),Q($,null,[c("section",G,[o(M,{title:"\u53EF\u4F9B\u9810\u7D04\u6642\u9593",rows:g,columns:F,"row-key":"id",selection:"single",selected:f.value,"onUpdate:selected":l[0]||(l[0]=s=>f.value=s)},null,8,["rows","selected"])]),c("div",J,[K,o(N,{modelValue:_.value,"onUpdate:modelValue":l[6]||(l[6]=s=>_.value=s),persistent:""},{default:r(()=>[o(j,{style:{"min-width":"400px"}},{default:r(()=>[o(m,null,{default:r(()=>[L]),_:1}),o(m,{class:"q-pt-none"},{default:r(()=>[o(b,{outlined:"",modelValue:u.date,"onUpdate:modelValue":l[1]||(l[1]=s=>u.date=s),dense:h.value,readonly:""},null,8,["modelValue","dense"])]),_:1}),o(m,null,{default:r(()=>[X]),_:1}),o(m,{class:"q-pt-none"},{default:r(()=>[o(b,{outlined:"",modelValue:u.time,"onUpdate:modelValue":l[2]||(l[2]=s=>u.time=s),dense:h.value,readonly:""},null,8,["modelValue","dense"])]),_:1}),o(m,null,{default:r(()=>[Z]),_:1}),o(m,{class:"q-pt-none"},{default:r(()=>[o(b,{outlined:"",modelValue:u.name,"onUpdate:modelValue":l[3]||(l[3]=s=>u.name=s),placeholder:"\u59D3\u540D",hint:"\u59D3\u540D",dense:h.value,rules:[s=>s&&s.length>1||"\u8ACB\u8F38\u5165\u4E8C\u5B57\u4EE5\u4E0A"]},null,8,["modelValue","dense","rules"])]),_:1}),o(m,null,{default:r(()=>[ee]),_:1}),o(m,{class:"q-pt-none"},{default:r(()=>[o(b,{outlined:"",modelValue:u.member,"onUpdate:modelValue":l[4]||(l[4]=s=>u.member=s),placeholder:"\u4EBA\u6578",hint:"\u4EBA\u6578",dense:h.value,rules:[s=>s>=1||"\u6700\u5C11\u9700\u9810\u7D041\u4F4D"]},null,8,["modelValue","dense","rules"])]),_:1}),o(m,null,{default:r(()=>[te]),_:1}),o(m,{class:"q-pt-none"},{default:r(()=>[o(b,{outlined:"",modelValue:u.phone,"onUpdate:modelValue":l[5]||(l[5]=s=>u.phone=s),dense:h.value},null,8,["modelValue","dense"])]),_:1}),o(O,{align:"right",class:"text-white"},{default:r(()=>[H(o(k,{flat:"",label:"\u53D6\u6D88",color:"secondary"},null,512),[[W]]),o(k,{onClick:A,label:"\u9810\u7D04",color:"teal"})]),_:1})]),_:1})]),_:1},8,["modelValue"]),f.value[0]?V("",!0):(B(),Q("div",le,"\u8ACB\u5148\u9078\u64C7\u60F3\u9810\u7D04\u7684\u6642\u9593")),f.value[0]?(B(),Q("div",ae," \u60A8\u9078\u64C7\u7684\u662F:"+C(f.value[0].date)+" "+C(f.value[0].time)+" ,\u91AB\u5E2B\u70BA:"+C(t.value),1)):V("",!0),f.value[0]?(B(),R(k,{key:2,label:"\u6211\u8981\u9810\u7D04",color:"primary",onClick:Y,class:"q-mt-md"})):V("",!0)])],64))}};export{pe as default};
