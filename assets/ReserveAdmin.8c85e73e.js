import{r as g,aR as q,s as B,t as w,v as U,x as y,f as i,y as f,Q as p,D as k,aW as C,aX as h,L,aM as T}from"./index.259f3f0b.js";import{Q as A,a as $}from"./QPopupProxy.62c9dff5.js";import{Q as D}from"./QInput.f73e3455.js";import{Q as E}from"./QTable.da1cfe8f.js";import{C as I}from"./ClosePopup.2e0ec6a6.js";import{u as N}from"./vue-i18n.runtime.esm-bundler.0f884c19.js";import"./use-cache.b0833c75.js";import"./use-key-composition.f7cc742c.js";import"./QCheckbox.bda9ead0.js";function Q(m){setTimeout(()=>{window.URL.revokeObjectURL(m.href)},1e4),m.remove()}function O(m,c,o={}){const{mimeType:d,byteOrderMark:r,encoding:v}=typeof o=="string"?{mimeType:o}:o,b=v!==void 0?new TextEncoder(v).encode([c]):c,u=r!==void 0?[r,b]:[b],n=new Blob(u,{type:d||"application/octet-stream"}),a=document.createElement("a");a.href=window.URL.createObjectURL(n),a.setAttribute("download",m),typeof a.download=="undefined"&&a.setAttribute("target","_blank"),a.classList.add("hidden"),a.style.position="fixed",document.body.appendChild(a);try{return a.click(),Q(a),!0}catch(_){return Q(a),_}}const P={class:"q-pa-md text-center"},M={class:"row items-center justify-end"},S={class:"row-xs column justify-center"},z={class:"row justify-center"},ee={__name:"ReserveAdmin",setup(m){const{t:c}=N(),o=g([]),d=q(),r=g(""),v=g("false"),b=g("id"),u=[{name:"_id",required:!0,label:"_id",align:"left",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"name",align:"center",label:c("name"),field:"name",sortable:!0},{name:"date",label:c("date"),field:"date",sortable:!0},{name:"time",label:c("time"),field:"time",sortable:!0},{name:"member",label:c("member"),field:"member",sortable:!0}],n=B([]),a=async()=>{const e=await h.get("/reserve/all");console.log(e.data.message),n.splice(0,n.length);let t=0;for(t=0;t<e.data.message.length;t++)n.push({date:e.data.message[t].date,time:e.data.message[t].time,member:e.data.message[t].member,id:e.data.message[t]._id,name:e.data.message[t].name});d.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u53D6\u5F97\u6210\u529F"})};a();function _(){a(),r.value="",v.value=!1,o.value=[]}const V=async()=>{try{console.log(o.value[0]);const e={id:o.value[0].id,time:o.value[0].time,date:o.value[0].date,member:o.value[0].member},t=await h.post("/reserve/cancel",e);for(console.log(t),d.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u522A\u9664\u6210\u529F"});n.length;)n.pop();a()}catch(e){console.log(e),d.notify({color:"red-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u522A\u9664\u5931\u6557"})}},j=async()=>{try{n.splice(0,n.length);const e=await h.post("/reserve/cancelall");console.log(e),d.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u522A\u9664\u6210\u529F"})}catch(e){console.log(e)}};function x(e,t,s){let l=t!==void 0?t(e,s):e;return l=l==null?"":String(l),l=l.split('"').join('""'),`"${l}"`}function R(){const e=[u.map(s=>x(s.label))].concat(n.map(s=>u.map(l=>x(typeof l.field=="function"?l.field(s):s[l.field===void 0?l.name:l.field],l.format,s)).join(","))).join(`\r
`);O("table-export.csv","\uFEFF"+e,"text/csv")!==!0&&d.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}return(e,t)=>(w(),U("section",null,[y("div",P,[i(E,{title:e.$t("reserveadmin"),rows:n,columns:u,"row-key":b.value,selection:"single",selected:o.value,"onUpdate:selected":t[2]||(t[2]=s=>o.value=s),filter:r.value},{"top-right":f(()=>[i(D,{filled:"",modelValue:r.value,"onUpdate:modelValue":t[1]||(t[1]=s=>r.value=s),mask:"date"},{append:f(()=>[i(L,{name:"calendar_today",class:"cursor-pointer"},{default:f(()=>[i(A,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:f(()=>[i($,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=s=>r.value=s),"today-btn":""},{default:f(()=>[y("div",M,[T(i(p,{label:"Close",color:"primary",flat:""},null,512),[[I]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["title","rows","row-key","selected","filter"])]),y("div",S,[i(p,{color:"primary",icon:"archive",label:"\u7522\u751Fcsv","no-caps":"",onClick:R,class:"q-mx-md"}),o.value[0]?(w(),k(p,{key:0,color:"teal",icon:"delete",onClick:V,label:"\u522A\u9664",class:"q-mx-md"})):C("",!0),o.value[0]?C("",!0):(w(),k(p,{key:1,color:"teal",icon:"delete",onClick:j,label:"\u4E00\u9375\u5168\u522A",class:"q-mx-md"}))]),y("div",z,[i(p,{icon:"reply",label:"\u8FD4\u56DE",class:"q-mt-xl",onClick:_,color:"teal"})])]))}};export{ee as default};
