import{Q as N,e as Q}from"./QTable.66be56f5.js";import{r as x,aR as P,s as C,t as k,v as F,x as s,f as e,Q as r,aM as m,D as I,aW as L,y as l,F as R,aX as y,L as V,b5 as q}from"./index.28386664.js";import{Q as d}from"./QCardSection.65fba01d.js";import{Q as b,a as h}from"./QPopupProxy.761ad742.js";import{Q as p}from"./QInput.a1411147.js";import{Q as U}from"./QTime.6ffe9284.js";import{Q as D}from"./QCardActions.fd5c7caa.js";import{Q as $}from"./QCard.e1264f17.js";import{C as c}from"./ClosePopup.f726989a.js";import"./use-key-composition.10644b8a.js";import"./QCheckbox.ff9b47af.js";import"./use-cache.b0833c75.js";const T={class:"q-pa-md"},W={class:"text-center",id:"btns"},E=s("div",{class:"text-h6"},"\u65E5\u671F",-1),M={class:"row items-center justify-end"},X=s("div",{class:"text-h6"},"\u6642\u9593",-1),z={class:"row items-center justify-end"},G=s("div",{class:"text-h6"},"\u4EBA\u6578",-1),H=s("div",{class:"text-h6"},"\u958B\u59CB\u65E5\u671F",-1),J={class:"row items-center justify-end"},O=s("div",{class:"text-h6"},"\u7D50\u675F\u65E5\u671F",-1),Y={class:"row items-center justify-end"},Z=s("div",{class:"text-h6"},"\u4EBA\u6578",-1),ee=s("div",{class:"text-h6"},"\u6642\u9593",-1),te={class:"row items-center justify-end"},_e={__name:"LimitAdmin",setup(le){const v=x(!1),w=x(!1),f=P(),i=C({date:"",time:"",member:""}),n=C({startDate:"",endDate:"",time:"",member:""}),u=C([]),g=x([]),_=async()=>{const a=await y.get("/reserve");console.log(a.data.result);let t=0;for(t=0;t<a.data.result.length;t++)a.data.result[t].member!==0&&u.push({date:a.data.result[t].date,time:a.data.result[t].time,member:a.data.result[t].member,id:a.data.result[t]._id});f.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u53EF\u9810\u7D04\u53D6\u5F97\u6210\u529F"})};_();const j=async()=>{const a=await y.post("/reserve/",i);for(console.log(a),f.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u65B0\u589E\u6210\u529F"});u.length;)u.pop();_()},B=async()=>{try{const a=await y.post("/reserve/week",n);for(console.log(a),f.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u65B0\u589E\u6210\u529F"});u.length;)u.pop();_()}catch{f.notify({color:"red-4",textColor:"white",icon:"cloud_done",message:"\u65B0\u589E\u6210\u529F"})}},S=async()=>{try{const a=await y.delete(`/reserve/${g.value[0].id}`);for(console.log(a),f.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u522A\u9664\u6210\u529F"});u.length;)u.pop();_()}catch{f.notify({color:"red-4",textColor:"white",icon:"cloud_off",message:"\u8ACB\u9078\u64C7\u8981\u522A\u9664\u7684\u9805\u76EE"})}},A=async()=>{try{const a=await y.delete("/reserve/delete/all");console.log(a),u.splice(0,u.length),f.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u522A\u9664\u6210\u529F"}),_()}catch{f.notify({color:"red-4",textColor:"white",icon:"cloud_done",message:"\u522A\u9664\u5931\u6557"})}},K=[{name:"id",align:"center",label:"id",field:"id",sortable:!0},{name:"date",required:!0,label:"\u65E5\u671F",align:"left",field:a=>a.date,format:a=>`${a}`,sortable:!0},{name:"time",align:"center",label:"\u6642\u9593",field:"time",sortable:!0},{name:"member",label:"\u53EF\u9810\u7D04\u4EBA\u6578",field:"member",sortable:!0}];return(a,t)=>(k(),F(R,null,[s("section",null,[s("div",T,[e(N,{title:a.$t("limitadmin"),rows:u,columns:K,"row-key":"id",selection:"single",selected:g.value,"onUpdate:selected":t[0]||(t[0]=o=>g.value=o)},null,8,["title","rows","selected"])])]),s("section",null,[s("div",W,[e(r,{icon:"add",label:"\u65B0\u589E\u4E00\u5929",color:"primary",onClick:t[1]||(t[1]=o=>v.value=!0),class:"q-mr-md-xl q-my-xs-xs"}),e(r,{icon:"add_box",label:"\u65B0\u589E\u591A\u5929",color:"primary",onClick:t[2]||(t[2]=o=>w.value=!0),class:"q-mr-md-xl q-my-xs-xs"}),g.value[0]?m((k(),I(r,{key:0,color:"teal",label:"\u522A\u9664\u9078\u64C7",icon:"delete",onClick:S,class:"q-mr-md-xl q-my-xs-xs"},null,512)),[[c]]):L("",!0),e(r,{icon:"delete",color:"teal",label:"\u4E00\u9375\u5168\u522A",onClick:A})])]),e(Q,{modelValue:v.value,"onUpdate:modelValue":t[9]||(t[9]=o=>v.value=o),persistent:""},{default:l(()=>[e($,{style:{"min-width":"400px"}},{default:l(()=>[e(d,null,{default:l(()=>[E]),_:1}),e(d,{class:"q-pt-none"},{default:l(()=>[e(p,{filled:"",modelValue:i.date,"onUpdate:modelValue":t[4]||(t[4]=o=>i.date=o),mask:"date",rules:["date"]},{append:l(()=>[e(V,{name:"calendar_today",class:"cursor-pointer"},{default:l(()=>[e(b,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(h,{modelValue:i.date,"onUpdate:modelValue":t[3]||(t[3]=o=>i.date=o),"today-btn":""},{default:l(()=>[s("div",M,[m(e(r,{label:"Close",color:"primary",flat:""},null,512),[[c]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(d,null,{default:l(()=>[X]),_:1}),e(d,{class:"q-pt-none"},{default:l(()=>[e(p,{filled:"",modelValue:i.time,"onUpdate:modelValue":t[6]||(t[6]=o=>i.time=o),mask:"time",rules:["time"]},{append:l(()=>[e(V,{name:"access_time",class:"cursor-pointer"},{default:l(()=>[e(b,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(U,{modelValue:i.time,"onUpdate:modelValue":t[5]||(t[5]=o=>i.time=o),"now-btn":""},{default:l(()=>[s("div",z,[m(e(r,{label:"Close",color:"primary",flat:""},null,512),[[c]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(d,null,{default:l(()=>[G]),_:1}),e(d,{class:"q-pt-none"},{default:l(()=>[e(p,{dense:"",modelValue:i.member,"onUpdate:modelValue":t[7]||(t[7]=o=>i.member=o),autofocus:"",onKeyup:t[8]||(t[8]=q(o=>v.value=!1,["enter"]))},null,8,["modelValue"])]),_:1}),e(D,{align:"right",class:"text-white"},{default:l(()=>[m(e(r,{flat:"",color:"secondary",label:"\u53D6\u6D88"},null,512),[[c]]),m(e(r,{color:"teal",label:"\u65B0\u589E",onClick:j},null,512),[[c]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Q,{modelValue:w.value,"onUpdate:modelValue":t[18]||(t[18]=o=>w.value=o),persistent:""},{default:l(()=>[e($,{style:{"min-width":"400px"}},{default:l(()=>[e(d,null,{default:l(()=>[H]),_:1}),e(d,{class:"q-pt-none"},{default:l(()=>[e(p,{filled:"",modelValue:n.startDate,"onUpdate:modelValue":t[11]||(t[11]=o=>n.startDate=o),mask:"date",rules:["date"]},{append:l(()=>[e(V,{name:"calendar_today",class:"cursor-pointer"},{default:l(()=>[e(b,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(h,{modelValue:n.startDate,"onUpdate:modelValue":t[10]||(t[10]=o=>n.startDate=o),"today-btn":""},{default:l(()=>[s("div",J,[m(e(r,{label:"Close",color:"primary",flat:""},null,512),[[c]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(d,null,{default:l(()=>[O]),_:1}),e(d,{class:"q-pt-none"},{default:l(()=>[e(p,{filled:"",modelValue:n.endDate,"onUpdate:modelValue":t[13]||(t[13]=o=>n.endDate=o),mask:"date",rules:["date"]},{append:l(()=>[e(V,{name:"calendar_today",class:"cursor-pointer"},{default:l(()=>[e(b,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(h,{modelValue:n.endDate,"onUpdate:modelValue":t[12]||(t[12]=o=>n.endDate=o),"today-btn":""},{default:l(()=>[s("div",Y,[m(e(r,{label:"Close",color:"primary",flat:""},null,512),[[c]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(d,null,{default:l(()=>[Z]),_:1}),e(d,{class:"q-pt-none"},{default:l(()=>[e(p,{dense:"",modelValue:n.member,"onUpdate:modelValue":t[14]||(t[14]=o=>n.member=o),autofocus:"",onKeyup:t[15]||(t[15]=q(o=>w.value=!1,["enter"]))},null,8,["modelValue"])]),_:1}),e(d,null,{default:l(()=>[ee]),_:1}),e(d,{class:"q-pt-none"},{default:l(()=>[e(p,{filled:"",modelValue:n.time,"onUpdate:modelValue":t[17]||(t[17]=o=>n.time=o),mask:"time",rules:["time"]},{append:l(()=>[e(V,{name:"access_time",class:"cursor-pointer"},{default:l(()=>[e(b,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(U,{modelValue:n.time,"onUpdate:modelValue":t[16]||(t[16]=o=>n.time=o),"now-btn":""},{default:l(()=>[s("div",te,[m(e(r,{label:"Close",color:"primary",flat:""},null,512),[[c]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(D,{align:"right",class:"text-white"},{default:l(()=>[m(e(r,{flat:"",color:"secondary",label:"\u53D6\u6D88"},null,512),[[c]]),m(e(r,{color:"teal",label:"\u65B0\u589E",onClick:B},null,512),[[c]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{_e as default};
