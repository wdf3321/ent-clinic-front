import{Q as v}from"./QTable.4af85f87.js";import{r as y,aR as _,s as w,v as h,x,y as k,d as f,Q as b,aW as p}from"./index.9b6ce990.js";import"./use-key-composition.cd3e2b18.js";import"./QCheckbox.e2327c15.js";function g(r){setTimeout(()=>{window.URL.revokeObjectURL(r.href)},1e4),r.remove()}function R(r,o,s={}){const{mimeType:i,byteOrderMark:l,encoding:d}=typeof s=="string"?{mimeType:s}:s,c=d!==void 0?new TextEncoder(d).encode([o]):o,m=l!==void 0?[l,c]:[c],u=new Blob(m,{type:i||"application/octet-stream"}),e=document.createElement("a");e.href=window.URL.createObjectURL(u),e.setAttribute("download",r),typeof e.download=="undefined"&&e.setAttribute("target","_blank"),e.classList.add("hidden"),e.style.position="fixed",document.body.appendChild(e);try{return e.click(),g(e),!0}catch(t){return g(e),t}}const C={class:"q-pa-md text-center"},L={__name:"ReserveAdmin",setup(r){const o=y([]),s=_(),i=[{name:"_id",required:!0,label:"_id",align:"left",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"name",align:"center",label:"name",field:"name",sortable:!0},{name:"date",label:"date",field:"date",sortable:!0},{name:"time",label:"time",field:"time",sortable:!0},{name:"member",label:"member",field:"member",sortable:!0}],l=w([]),d=async()=>{const e=await p.get("/reserve/all");console.log(e.data.message);let t=0;for(t=0;t<e.data.message.length;t++)l.push({date:e.data.message[t].date,time:e.data.message[t].time,member:e.data.message[t].member,id:e.data.message[t]._id,name:e.data.message[t].name});s.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u53D6\u5F97\u6210\u529F"})};d();const c=async()=>{try{console.log(o.value[0]);const e={id:o.value[0].id,time:o.value[0].time,date:o.value[0].date,member:o.value[0].member},t=await p.post("/reserve/cancel",e);for(console.log(t),s.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u522A\u9664\u6210\u529F"});l.length;)l.pop();d()}catch(e){console.log(e),s.notify({color:"red-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u522A\u9664\u5931\u6557"})}};function m(e,t,n){let a=t!==void 0?t(e,n):e;return a=a==null?"":String(a),a=a.split('"').join('""'),`"${a}"`}function u(){const e=[i.map(n=>m(n.label))].concat(l.map(n=>i.map(a=>m(typeof a.field=="function"?a.field(n):n[a.field===void 0?a.name:a.field],a.format,n)).join(","))).join(`\r
`);R("table-export.csv","\uFEFF"+e,"text/csv")!==!0&&s.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}return(e,t)=>(h(),x("section",null,[k("div",C,[f(v,{title:"\u9810\u7D04\u7BA1\u7406",rows:l,columns:i,"row-key":"id",selection:"single",selected:o.value,"onUpdate:selected":t[0]||(t[0]=n=>o.value=n)},null,8,["rows","selected"]),f(b,{color:"primary",icon:"archive",label:"\u7522\u751Fcsv","no-caps":"",onClick:u}),f(b,{color:"teal",icon:"delete",onClick:c,class:"q-ma-xl",label:"\u522A\u9664"})])]))}};export{L as default};
