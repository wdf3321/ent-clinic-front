import{Q as _}from"./QTable.467684ee.js";import{r as w,aR as x,s as h,t as f,v as k,x as b,d as p,Q as v,D as C,aW as R,aX as g}from"./index.de8cf485.js";import"./use-key-composition.09f48e6b.js";import"./QCheckbox.ba2b73e8.js";function y(r){setTimeout(()=>{window.URL.revokeObjectURL(r.href)},1e4),r.remove()}function B(r,o,s={}){const{mimeType:i,byteOrderMark:l,encoding:c}=typeof s=="string"?{mimeType:s}:s,d=c!==void 0?new TextEncoder(c).encode([o]):o,m=l!==void 0?[l,d]:[d],u=new Blob(m,{type:i||"application/octet-stream"}),e=document.createElement("a");e.href=window.URL.createObjectURL(u),e.setAttribute("download",r),typeof e.download=="undefined"&&e.setAttribute("target","_blank"),e.classList.add("hidden"),e.style.position="fixed",document.body.appendChild(e);try{return e.click(),y(e),!0}catch(t){return y(e),t}}const j={class:"q-pa-md text-center"},T={class:"row-xs column justify-center"},U={__name:"ReserveAdmin",setup(r){const o=w([]),s=x(),i=[{name:"_id",required:!0,label:"_id",align:"left",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"name",align:"center",label:"name",field:"name",sortable:!0},{name:"date",label:"date",field:"date",sortable:!0},{name:"time",label:"time",field:"time",sortable:!0},{name:"member",label:"member",field:"member",sortable:!0}],l=h([]),c=async()=>{const e=await g.get("/reserve/all");console.log(e.data.message);let t=0;for(t=0;t<e.data.message.length;t++)l.push({date:e.data.message[t].date,time:e.data.message[t].time,member:e.data.message[t].member,id:e.data.message[t]._id,name:e.data.message[t].name});s.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u53D6\u5F97\u6210\u529F"})};c();const d=async()=>{try{console.log(o.value[0]);const e={id:o.value[0].id,time:o.value[0].time,date:o.value[0].date,member:o.value[0].member},t=await g.post("/reserve/cancel",e);for(console.log(t),s.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u522A\u9664\u6210\u529F"});l.length;)l.pop();c()}catch(e){console.log(e),s.notify({color:"red-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u522A\u9664\u5931\u6557"})}};function m(e,t,n){let a=t!==void 0?t(e,n):e;return a=a==null?"":String(a),a=a.split('"').join('""'),`"${a}"`}function u(){const e=[i.map(n=>m(n.label))].concat(l.map(n=>i.map(a=>m(typeof a.field=="function"?a.field(n):n[a.field===void 0?a.name:a.field],a.format,n)).join(","))).join(`\r
`);B("table-export.csv","\uFEFF"+e,"text/csv")!==!0&&s.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}return(e,t)=>(f(),k("section",null,[b("div",j,[p(_,{title:"\u9810\u7D04\u7BA1\u7406",rows:l,columns:i,"row-key":"id",selection:"single",selected:o.value,"onUpdate:selected":t[0]||(t[0]=n=>o.value=n)},null,8,["rows","selected"])]),b("div",T,[p(v,{color:"primary",icon:"archive",label:"\u7522\u751Fcsv","no-caps":"",onClick:u,class:"q-mx-md"}),o.value[0]?(f(),C(v,{key:0,color:"teal",icon:"delete",onClick:d,label:"\u522A\u9664",class:"q-mx-md"})):R("",!0)])]))}};export{U as default};
