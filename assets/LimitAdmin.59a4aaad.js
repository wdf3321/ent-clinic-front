import{Q as M,e as Q}from"./QTable.dd2a59ad.js";import{r as g,v as T,x as k,y as q,z,A as s,f as e,Q as d,aQ as i,H as B,I as j,B as t,F as E,aY as v,P as V,b6 as Y,aX as H}from"./index.b3b8d4e1.js";import{Q as r}from"./QCardSection.08d2018b.js";import{Q as b,a as U}from"./QPopupProxy.a42bce31.js";import{Q as p}from"./QInput.b374918a.js";import{Q as A}from"./QTime.f814cba1.js";import{Q as D,C as u}from"./ClosePopup.8e0ed103.js";import{Q as $}from"./QCard.1ab936ad.js";import{u as L}from"./vue-i18n.runtime.esm-bundler.4359bcd2.js";import{h as I}from"./moment.9709ab41.js";import"./use-key-composition.7098da9a.js";import"./QCheckbox.2b4e773d.js";import"./use-cache.b0833c75.js";const R={class:"q-pa-md"},W={class:"text-center",id:"btns"},X=s("div",{class:"text-h6"},"\u65E5\u671F",-1),G={class:"row items-center justify-end"},J=s("div",{class:"text-h6"},"\u6642\u9593",-1),O={class:"row items-center justify-end"},Z=s("div",{class:"text-h6"},"\u4EBA\u6578",-1),ee=s("div",{class:"text-h6"},"\u958B\u59CB\u65E5\u671F",-1),le={class:"row items-center justify-end"},te=s("div",{class:"text-h6"},"\u7D50\u675F\u65E5\u671F",-1),oe={class:"row items-center justify-end"},ae=s("div",{class:"text-h6"},"\u4EBA\u6578",-1),se=s("div",{class:"text-h6"},"\u6642\u9593",-1),ne={class:"row items-center justify-end"},de=s("span",{class:"q-ml-sm"},"\u4F60\u78BA\u5B9A\u8981\u522A\u9664\uFF1F",-1),ge={__name:"LimitAdmin",setup(re){const{t:C}=L(),w=g(!1),x=g(!1),f=T(),m=k({date:"",time:"",member:""}),n=k({startDate:"",endDate:"",time:"",member:""}),c=k([]),y=g([]),h=g(!1),_=async()=>{const a=await v.get("/reserve");console.log(a.data.result);let l=0;for(l=0;l<a.data.result.length;l++)if(a.data.result[l].member!==0){if(I(a.data.result[l].date).isBefore(I().format("YYYY/MM/DD")))continue;c.push({date:a.data.result[l].date,time:a.data.result[l].time,member:a.data.result[l].member,id:a.data.result[l]._id})}f.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u53EF\u9810\u7D04\u53D6\u5F97\u6210\u529F"})};_();const P=async()=>{const a=await v.post("/reserve/",m);for(console.log(a),f.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u65B0\u589E\u6210\u529F"});c.length;)c.pop();_()},S=async()=>{try{const a=await v.post("/reserve/week",n);for(console.log(a),f.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u65B0\u589E\u6210\u529F"});c.length;)c.pop();_()}catch{f.notify({color:"red-4",textColor:"white",icon:"cloud_done",message:"\u65B0\u589E\u6210\u529F"})}},K=async()=>{try{const a=await v.delete(`/reserve/${y.value[0].id}`);for(console.log(a),f.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u522A\u9664\u6210\u529F"});c.length;)c.pop();_()}catch{f.notify({color:"red-4",textColor:"white",icon:"cloud_off",message:"\u8ACB\u9078\u64C7\u8981\u522A\u9664\u7684\u9805\u76EE"})}},N=async()=>{try{const a=await v.delete("/reserve/delete/all");console.log(a),c.splice(0,c.length),f.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u522A\u9664\u6210\u529F"}),_()}catch{f.notify({color:"red-4",textColor:"white",icon:"cloud_done",message:"\u522A\u9664\u5931\u6557"})}},F=[{name:"id",align:"center",label:"id",field:"id",sortable:!0},{name:"date",required:!0,label:C("date"),align:"left",field:a=>a.date,format:a=>`${a}`,sortable:!0},{name:"time",align:"center",label:C("time"),field:"time",sortable:!0},{name:"member",label:C("limit"),field:"member",sortable:!0}];return(a,l)=>(q(),z(E,null,[s("section",null,[s("div",R,[e(M,{title:a.$t("limitadmin"),rows:c,columns:F,"row-key":"id",selection:"single",selected:y.value,"onUpdate:selected":l[0]||(l[0]=o=>y.value=o)},null,8,["title","rows","selected"])])]),s("section",null,[s("div",W,[e(d,{icon:"add",label:"\u65B0\u589E\u4E00\u5929",color:"primary",onClick:l[1]||(l[1]=o=>w.value=!0),class:"q-mr-md-xl q-my-xs-xs"}),e(d,{icon:"add_box",label:"\u65B0\u589E\u591A\u5929",color:"primary",onClick:l[2]||(l[2]=o=>x.value=!0),class:"q-mr-md-xl q-my-xs-xs"}),y.value[0]?i((q(),B(d,{key:0,color:"teal",label:"\u522A\u9664\u9078\u64C7",icon:"delete",onClick:K,class:"q-mr-md-xl q-my-xs-xs"},null,512)),[[u]]):j("",!0),y.value[0]?j("",!0):(q(),B(d,{key:1,icon:"delete",color:"teal",label:"\u4E00\u9375\u5168\u522A",onClick:l[3]||(l[3]=o=>h.value=!0),class:"q-mr-md-xl q-my-xs-xs"}))])]),e(Q,{modelValue:w.value,"onUpdate:modelValue":l[10]||(l[10]=o=>w.value=o),persistent:""},{default:t(()=>[e($,{style:{"min-width":"400px"}},{default:t(()=>[e(r,null,{default:t(()=>[X]),_:1}),e(r,{class:"q-pt-none"},{default:t(()=>[e(p,{filled:"",modelValue:m.date,"onUpdate:modelValue":l[5]||(l[5]=o=>m.date=o),mask:"date",rules:["date"]},{append:t(()=>[e(V,{name:"calendar_today",class:"cursor-pointer"},{default:t(()=>[e(b,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:t(()=>[e(U,{modelValue:m.date,"onUpdate:modelValue":l[4]||(l[4]=o=>m.date=o),"today-btn":""},{default:t(()=>[s("div",G,[i(e(d,{label:"Close",color:"primary",flat:""},null,512),[[u]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(r,null,{default:t(()=>[J]),_:1}),e(r,{class:"q-pt-none"},{default:t(()=>[e(p,{filled:"",modelValue:m.time,"onUpdate:modelValue":l[7]||(l[7]=o=>m.time=o),mask:"time",rules:["time"]},{append:t(()=>[e(V,{name:"access_time",class:"cursor-pointer"},{default:t(()=>[e(b,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:t(()=>[e(A,{modelValue:m.time,"onUpdate:modelValue":l[6]||(l[6]=o=>m.time=o),"now-btn":""},{default:t(()=>[s("div",O,[i(e(d,{label:"Close",color:"primary",flat:""},null,512),[[u]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(r,null,{default:t(()=>[Z]),_:1}),e(r,{class:"q-pt-none"},{default:t(()=>[e(p,{dense:"",modelValue:m.member,"onUpdate:modelValue":l[8]||(l[8]=o=>m.member=o),autofocus:"",onKeyup:l[9]||(l[9]=Y(o=>w.value=!1,["enter"]))},null,8,["modelValue"])]),_:1}),e(D,{align:"right",class:"text-white"},{default:t(()=>[i(e(d,{flat:"",color:"secondary",label:"\u53D6\u6D88"},null,512),[[u]]),i(e(d,{color:"teal",label:"\u65B0\u589E",onClick:P},null,512),[[u]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Q,{modelValue:x.value,"onUpdate:modelValue":l[19]||(l[19]=o=>x.value=o),persistent:""},{default:t(()=>[e($,{style:{"min-width":"400px"}},{default:t(()=>[e(r,null,{default:t(()=>[ee]),_:1}),e(r,{class:"q-pt-none"},{default:t(()=>[e(p,{filled:"",modelValue:n.startDate,"onUpdate:modelValue":l[12]||(l[12]=o=>n.startDate=o),mask:"date",rules:["date"]},{append:t(()=>[e(V,{name:"calendar_today",class:"cursor-pointer"},{default:t(()=>[e(b,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:t(()=>[e(U,{modelValue:n.startDate,"onUpdate:modelValue":l[11]||(l[11]=o=>n.startDate=o),"today-btn":""},{default:t(()=>[s("div",le,[i(e(d,{label:"Close",color:"primary",flat:""},null,512),[[u]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(r,null,{default:t(()=>[te]),_:1}),e(r,{class:"q-pt-none"},{default:t(()=>[e(p,{filled:"",modelValue:n.endDate,"onUpdate:modelValue":l[14]||(l[14]=o=>n.endDate=o),mask:"date",rules:["date"]},{append:t(()=>[e(V,{name:"calendar_today",class:"cursor-pointer"},{default:t(()=>[e(b,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:t(()=>[e(U,{modelValue:n.endDate,"onUpdate:modelValue":l[13]||(l[13]=o=>n.endDate=o),"today-btn":""},{default:t(()=>[s("div",oe,[i(e(d,{label:"Close",color:"primary",flat:""},null,512),[[u]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(r,null,{default:t(()=>[ae]),_:1}),e(r,{class:"q-pt-none"},{default:t(()=>[e(p,{dense:"",modelValue:n.member,"onUpdate:modelValue":l[15]||(l[15]=o=>n.member=o),autofocus:"",onKeyup:l[16]||(l[16]=Y(o=>x.value=!1,["enter"]))},null,8,["modelValue"])]),_:1}),e(r,null,{default:t(()=>[se]),_:1}),e(r,{class:"q-pt-none"},{default:t(()=>[e(p,{filled:"",modelValue:n.time,"onUpdate:modelValue":l[18]||(l[18]=o=>n.time=o),mask:"time",rules:["time"]},{append:t(()=>[e(V,{name:"access_time",class:"cursor-pointer"},{default:t(()=>[e(b,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:t(()=>[e(A,{modelValue:n.time,"onUpdate:modelValue":l[17]||(l[17]=o=>n.time=o),"now-btn":""},{default:t(()=>[s("div",ne,[i(e(d,{label:"Close",color:"primary",flat:""},null,512),[[u]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(D,{align:"right",class:"text-white"},{default:t(()=>[i(e(d,{flat:"",color:"secondary",label:"\u53D6\u6D88"},null,512),[[u]]),i(e(d,{color:"teal",label:"\u65B0\u589E",onClick:S},null,512),[[u]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Q,{modelValue:h.value,"onUpdate:modelValue":l[20]||(l[20]=o=>h.value=o),persistent:""},{default:t(()=>[e($,{style:{"min-width":"200px"}},{default:t(()=>[e(r,{class:"row items-center justify-center"},{default:t(()=>[e(H,{icon:"help",color:"teal","text-color":"white"}),de]),_:1}),e(D,{align:"center"},{default:t(()=>[i(e(d,{flat:"",label:"Cancel",color:"primary"},null,512),[[u]]),i(e(d,{flat:"",label:"Yes",color:"primary",onClick:N},null,512),[[u]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{ge as default};
