import{r as g,aR as R,s as q,t as w,v as B,x as y,f as c,y as f,Q as p,D as k,aW as C,aX as h,L as U,aM as L}from"./index.2e4e4508.js";import{Q as T,a as A}from"./QPopupProxy.1e41ce76.js";import{Q as $}from"./QInput.980ca0a4.js";import{Q as D}from"./QTable.68509b41.js";import{C as E}from"./ClosePopup.eb1deeb6.js";import"./use-cache.b0833c75.js";import"./use-key-composition.134a8d1b.js";import"./QCheckbox.e5f91381.js";function Q(m){setTimeout(()=>{window.URL.revokeObjectURL(m.href)},1e4),m.remove()}function N(m,a,r={}){const{mimeType:i,byteOrderMark:v,encoding:b}=typeof r=="string"?{mimeType:r}:r,d=b!==void 0?new TextEncoder(b).encode([a]):a,n=v!==void 0?[v,d]:[d],u=new Blob(n,{type:i||"application/octet-stream"}),s=document.createElement("a");s.href=window.URL.createObjectURL(u),s.setAttribute("download",m),typeof s.download=="undefined"&&s.setAttribute("target","_blank"),s.classList.add("hidden"),s.style.position="fixed",document.body.appendChild(s);try{return s.click(),Q(s),!0}catch(_){return Q(s),_}}const O={class:"q-pa-md text-center"},P={class:"row items-center justify-end"},I={class:"row-xs column justify-center"},M={class:"row justify-center"},K={__name:"ReserveAdmin",setup(m){const a=g([]),r=R(),i=g(""),v=g("false"),b=g("id"),d=[{name:"_id",required:!0,label:"_id",align:"left",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"name",align:"center",label:"name",field:"name",sortable:!0},{name:"date",label:"date",field:"date",sortable:!0},{name:"time",label:"time",field:"time",sortable:!0},{name:"member",label:"member",field:"member",sortable:!0}],n=q([]),u=async()=>{const e=await h.get("/reserve/all");console.log(e.data.message),n.splice(0,n.length);let t=0;for(t=0;t<e.data.message.length;t++)n.push({date:e.data.message[t].date,time:e.data.message[t].time,member:e.data.message[t].member,id:e.data.message[t]._id,name:e.data.message[t].name});r.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u53D6\u5F97\u6210\u529F"})};u();function s(){u(),i.value="",v.value=!1,a.value=[]}const _=async()=>{try{console.log(a.value[0]);const e={id:a.value[0].id,time:a.value[0].time,date:a.value[0].date,member:a.value[0].member},t=await h.post("/reserve/cancel",e);for(console.log(t),r.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u522A\u9664\u6210\u529F"});n.length;)n.pop();u()}catch(e){console.log(e),r.notify({color:"red-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u522A\u9664\u5931\u6557"})}},V=async()=>{try{n.splice(0,n.length);const e=await h.post("/reserve/cancelall");console.log(e),r.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u522A\u9664\u6210\u529F"})}catch(e){console.log(e)}};function x(e,t,l){let o=t!==void 0?t(e,l):e;return o=o==null?"":String(o),o=o.split('"').join('""'),`"${o}"`}function j(){const e=[d.map(l=>x(l.label))].concat(n.map(l=>d.map(o=>x(typeof o.field=="function"?o.field(l):l[o.field===void 0?o.name:o.field],o.format,l)).join(","))).join(`\r
`);N("table-export.csv","\uFEFF"+e,"text/csv")!==!0&&r.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}return(e,t)=>(w(),B("section",null,[y("div",O,[c(D,{title:e.$t("reserveadmin"),rows:n,columns:d,"row-key":b.value,selection:"single",selected:a.value,"onUpdate:selected":t[2]||(t[2]=l=>a.value=l),filter:i.value},{"top-right":f(()=>[c($,{filled:"",modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=l=>i.value=l),mask:"date"},{append:f(()=>[c(U,{name:"calendar_today",class:"cursor-pointer"},{default:f(()=>[c(T,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:f(()=>[c(A,{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=l=>i.value=l),"today-btn":""},{default:f(()=>[y("div",P,[L(c(p,{label:"Close",color:"primary",flat:""},null,512),[[E]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["title","rows","row-key","selected","filter"])]),y("div",I,[c(p,{color:"primary",icon:"archive",label:"\u7522\u751Fcsv","no-caps":"",onClick:j,class:"q-mx-md"}),a.value[0]?(w(),k(p,{key:0,color:"teal",icon:"delete",onClick:_,label:"\u522A\u9664",class:"q-mx-md"})):C("",!0),a.value[0]?C("",!0):(w(),k(p,{key:1,color:"teal",icon:"delete",onClick:V,label:"\u4E00\u9375\u5168\u522A",class:"q-mx-md"}))]),y("div",M,[c(p,{icon:"reply",label:"\u8FD4\u56DE",class:"q-mt-xl",onClick:s,color:"teal"})])]))}};export{K as default};
