import{Q as N}from"./QImg.6d3a94f4.js";import{Q as $}from"./QTd.b4d230fb.js";import{Q as j,d as D,e as I}from"./QTable.c8409308.js";import{aR as E,r as w,s as V,t as c,v as x,x as i,f as l,y as n,D as y,E as h,Q as m,F as S,aW as p,aN as b}from"./index.d9b7936b.js";import{Q as g}from"./QInput.6961785b.js";import{Q as d}from"./QCardSection.7fc99118.js";import{Q as T}from"./QCardActions.09fb4fcc.js";import{Q as O}from"./QCard.2faad377.js";import{C}from"./ClosePopup.b4bc0923.js";import{u as P}from"./vue-i18n.runtime.esm-bundler.db593ffc.js";import"./use-key-composition.786bfba1.js";import"./QCheckbox.1a78b906.js";const R={id:"useradmin"},W={class:"q-pa-md text-center"},z={class:"q-pa-md text-center column row-xs justify-center"},G={key:0,class:"q-pa-md text-center column row-xs"},H={key:1,class:"q-pa-md text-center column row-xs justify-center"},J={class:"row justify-center"},K=i("div",{class:"text-h6"},"id",-1),L=i("div",{class:"text-h6"},"\u540D\u5B57",-1),M=i("div",{class:"text-h6"},"\u5E33\u865F",-1),X=i("div",{class:"text-h6"},"\u624B\u6A5F",-1),Y=i("div",{class:"text-h6"},"\u6B0A\u9650:\u7BA1\u7406\u54E1:1 \u4F7F\u7528\u8005:0",-1),me={__name:"UserAdmin",setup(Z){const{t:f}=P(),u=E(),t=w([]),Q=["\u540D\u5B57","\u5E33\u865F","\u96FB\u8A71"],v=w(!1),q=[{name:"image",label:f("image"),align:"left"},{name:"id",required:!0,label:"id",align:"left",field:"id",sortable:!0},{name:"account",align:"left",label:f("account"),field:"account",sortable:!0},{name:"name",align:"left",label:f("name"),field:"name",sortable:!0},{name:"phone",align:"left",label:f("phone"),field:"phone",sortable:!0},{name:"role",align:"left",label:f("role"),field:"role",sortable:!0}];function k(){v.value=!0}const s=V([]),_=async()=>{const o=await p.get("/users/all");s.splice(0,s.length);let e=0;for(e=0;e<o.data.result.data.length;e++)s.push({id:o.data.result.data[e]._id,account:o.data.result.data[e].account,name:o.data.result.data[e].name,phone:o.data.result.data[e].phone,role:o.data.result.data[e].role});u.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u6703\u54E1\u53D6\u5F97\u6210\u529F"})};_();const r=V({search:"",select:""}),U=async()=>{var o;try{if(console.log(r),r.select==="\u540D\u5B57"){const e=await p.post("users/search/name",r);s.splice(0,s.length);let a=0;for(a=0;a<=e.data.message.length;a++)s.push({id:e.data.message[a]._id,account:e.data.message[a].account,name:e.data.message[a].name,phone:e.data.message[a].phone,role:e.data.message[a].role});u.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u641C\u5C0B\u6210\u529F"})}else if(r.select==="\u5E33\u865F"){const e=await p.post("users/search/account",r);s.splice(0,s.length);let a=0;for(a=0;a<=e.data.message.length;a++)s.push({id:e.data.message[a]._id,account:e.data.message[a].account,name:e.data.message[a].name,phone:e.data.message[a].phone,role:e.data.message[a].role});u.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u641C\u5C0B\u6210\u529F"})}else if(r.select==="\u96FB\u8A71"){const e=await p.post("users/search/phone",r);s.splice(0,s.length),console.log(e.data.message);let a=0;for(a=0;a<=e.data.message.length;a++)s.push({id:(o=e.data.message[a])==null?void 0:o._id,account:e.data.message[a].account,name:e.data.message[a].name,phone:e.data.message[a].phone,role:e.data.message[a].role})}u.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u641C\u5C0B\u6210\u529F"})}catch(e){console.log(e)}},A=async()=>{try{const o=await p.delete(`/users/${t.value[0].id}`);for(console.log(o),u.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u522A\u9664\u6210\u529F"});s.length;)s.pop();_()}catch{u.notify({color:"red-4",textColor:"white",icon:"cloud_done",message:"\u522A\u9664\u5931\u6557"})}},B=async()=>{try{console.log(t==null?void 0:t.value[0]),await p.patch(`/users/admin/${t==null?void 0:t.value[0].id}`,t.value[0]),await u.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u4FEE\u6539\u6210\u529F"})}catch(o){u.notify({color:"red-4",textColor:"white",icon:"info",message:o.message})}},F=()=>{t.value=[],_()};return(o,e)=>(c(),x(S,null,[i("section",R,[i("div",W,[l(j,{title:o.$t("useradmin"),rows:s,columns:q,"row-key":"name",selection:"single",selected:t.value,"onUpdate:selected":e[0]||(e[0]=a=>t.value=a)},{"body-cell-image":n(a=>[l($,{style:{width:"10px"}},{default:n(()=>[l(N,{src:`https://source.boringavatars.com/beam/${a.row.account}?colors=53C2BA,C0538A,F4C752,060614,F5F5F4`,height:"70px",width:"70px"},null,8,["src"])]),_:2},1024)]),_:1},8,["title","rows","selected"])]),i("div",z,[t.value[0]?(c(),y(m,{key:0,icon:"edit",label:"\u4FEE\u6539",onClick:k,class:"q-ma-xl",color:"teal"})):h("",!0),t.value[0]?(c(),y(m,{key:1,icon:"delete",label:"\u522A\u9664",onClick:A,class:"q-ma-xl",color:"teal"})):h("",!0)]),t.value[0]?h("",!0):(c(),x("div",G,[l(g,{outlined:"",modelValue:r.search,"onUpdate:modelValue":e[1]||(e[1]=a=>r.search=a),label:"\u641C\u5C0B","stack-label":"",style:{margin:"auto",width:"400px","margin-bottom":"8px"}},null,8,["modelValue"])])),t.value[0]?h("",!0):(c(),x("div",H,[l(m,{icon:"search",label:"\u641C\u5C0B",onClick:U,class:"q-mr-md-xl q-my-md",color:"primary"}),l(D,{outlined:"",modelValue:r.select,"onUpdate:modelValue":e[2]||(e[2]=a=>r.select=a),options:Q,label:"\u641C\u5C0B\u985E\u5225",id:"option"},null,8,["modelValue"])])),i("div",J,[t.value[0]?(c(),y(m,{key:0,icon:"reply",label:"\u8FD4\u56DE",class:"q-mt-xs",onClick:F,color:"teal"})):h("",!0)])]),l(I,{modelValue:v.value,"onUpdate:modelValue":e[8]||(e[8]=a=>v.value=a),persistent:""},{default:n(()=>[l(O,{style:{width:"400px"}},{default:n(()=>[l(d,null,{default:n(()=>[K]),_:1}),l(d,{class:"q-pt-none"},{default:n(()=>[l(g,{outline:"",modelValue:t.value[0].id,"onUpdate:modelValue":e[3]||(e[3]=a=>t.value[0].id=a),readonly:""},null,8,["modelValue"])]),_:1}),l(d,null,{default:n(()=>[L]),_:1}),l(d,{class:"q-pt-none"},{default:n(()=>[l(g,{outline:"",modelValue:t.value[0].name,"onUpdate:modelValue":e[4]||(e[4]=a=>t.value[0].name=a)},null,8,["modelValue"])]),_:1}),l(d,null,{default:n(()=>[M]),_:1}),l(d,{class:"q-pt-none"},{default:n(()=>[l(g,{outline:"",modelValue:t.value[0].account,"onUpdate:modelValue":e[5]||(e[5]=a=>t.value[0].account=a)},null,8,["modelValue"])]),_:1}),l(d,null,{default:n(()=>[X]),_:1}),l(d,{class:"q-pt-none"},{default:n(()=>[l(g,{outline:"",modelValue:t.value[0].phone,"onUpdate:modelValue":e[6]||(e[6]=a=>t.value[0].phone=a)},null,8,["modelValue"])]),_:1}),l(d,null,{default:n(()=>[Y]),_:1}),l(d,{class:"q-pt-none"},{default:n(()=>[l(g,{outline:"",modelValue:t.value[0].role,"onUpdate:modelValue":e[7]||(e[7]=a=>t.value[0].role=a)},null,8,["modelValue"])]),_:1}),l(T,{align:"right",class:"text-primary"},{default:n(()=>[b(l(m,{flat:"",label:"\u53D6\u6D88"},null,512),[[C]]),b(l(m,{flat:"",label:"\u66F4\u6539",onClick:B},null,512),[[C]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{me as default};
