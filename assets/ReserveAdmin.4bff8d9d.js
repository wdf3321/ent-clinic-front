import{Q as v}from"./QTable.45c2df84.js";import{r as y,aR as _,s as w,v as h,x,y as k,d as f,Q as p,aW as b}from"./index.4fc50fb4.js";import"./use-key-composition.66f2c17d.js";import"./QCheckbox.d43d84e2.js";function g(r){setTimeout(()=>{window.URL.revokeObjectURL(r.href)},1e4),r.remove()}function R(r,l,n={}){const{mimeType:i,byteOrderMark:s,encoding:d}=typeof n=="string"?{mimeType:n}:n,c=d!==void 0?new TextEncoder(d).encode([l]):l,m=s!==void 0?[s,c]:[c],u=new Blob(m,{type:i||"application/octet-stream"}),e=document.createElement("a");e.href=window.URL.createObjectURL(u),e.setAttribute("download",r),typeof e.download=="undefined"&&e.setAttribute("target","_blank"),e.classList.add("hidden"),e.style.position="fixed",document.body.appendChild(e);try{return e.click(),g(e),!0}catch(t){return g(e),t}}const C={class:"q-pa-md text-center"},L={__name:"ReserveAdmin",setup(r){const l=y([]),n=_(),i=[{name:"_id",required:!0,label:"_id",align:"left",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"name",align:"center",label:"name",field:"name",sortable:!0},{name:"date",label:"date",field:"date",sortable:!0},{name:"time",label:"time",field:"time",sortable:!0},{name:"member",label:"member",field:"member",sortable:!0}],s=w([]),d=async()=>{const e=await b.get("/reserve/all");console.log(e.data.message);let t=0;for(t=0;t<e.data.message.length;t++)s.push({date:e.data.message[t].date,time:e.data.message[t].time,member:e.data.message[t].member,id:e.data.message[t]._id,name:e.data.message[t].name});n.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u53D6\u5F97\u6210\u529F"})};d();const c=async()=>{try{console.log(l.value[0].id);const e=await b.delete(`/reserve/delete/${l.value[0].id}`);for(console.log(e),n.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u53D6\u5F97\u6210\u529F"});s.length;)s.pop();d()}catch(e){console.log(e),n.notify({color:"red-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u53D6\u5F97\u6210\u529F"})}};function m(e,t,o){let a=t!==void 0?t(e,o):e;return a=a==null?"":String(a),a=a.split('"').join('""'),`"${a}"`}function u(){const e=[i.map(o=>m(o.label))].concat(s.map(o=>i.map(a=>m(typeof a.field=="function"?a.field(o):o[a.field===void 0?a.name:a.field],a.format,o)).join(","))).join(`\r
`);R("table-export.csv",e,"text/csv")!==!0&&n.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}return(e,t)=>(h(),x("section",null,[k("div",C,[f(v,{title:"\u9810\u7D04\u7BA1\u7406",rows:s,columns:i,"row-key":"id",selection:"single",selected:l.value,"onUpdate:selected":t[0]||(t[0]=o=>l.value=o)},null,8,["rows","selected"]),f(p,{color:"primary",icon:"archive",label:"\u7522\u751Fcsv","no-caps":"",onClick:u}),f(p,{color:"teal",icon:"delete",onClick:c,class:"q-ma-xl",label:"\u522A\u9664"})])]))}};export{L as default};
