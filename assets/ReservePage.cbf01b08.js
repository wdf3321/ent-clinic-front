import{Q as q,d as k,j as Q}from"./QTable.45c2df84.js";import{Q as n}from"./QCardSection.9d80e91f.js";import{Q as w}from"./QInput.d80e9bc5.js";import{aR as U,r as f,s as u,v as B,x as R,y as d,d as l,z as a,Q as _,F as D,aW as x,aN as N}from"./index.4fc50fb4.js";import{Q as P}from"./QCardActions.692749bf.js";import{Q as $}from"./QCard.9be33f9d.js";import{C as A}from"./ClosePopup.9ce12936.js";import"./use-key-composition.66f2c17d.js";import"./QCheckbox.d43d84e2.js";const F={class:"q-pa-md text-center"},S={class:"q-pa-md text-center"},T=d("h4",{class:""},"\u6211\u8981\u9810\u7D04",-1),j=d("div",{class:"text-h6"},"\u59D3\u540D",-1),z=d("div",{class:"text-h6"},"\u4EBA\u6578",-1),E=d("div",{class:"text-h6"},"\u65E5\u671F",-1),I=d("div",{class:"text-h6"},"\u6642\u9593",-1),Z={__name:"ReservePage",setup(W){var h,V;const m=U(),r=f(!1),g=f(!1),v=f([]),c=u([]),p=u([]),b=async()=>{const t=await x.get("/reserve");let e=0;for(e=0;e<t.data.result.length;e++)t.data.result[e].member<=0||(i.push({date:t.data.result[e].date,time:t.data.result[e].time,member:t.data.result[e].member,id:t.data.result[e]._id}),c.includes(t.data.result[e].date)||c.push(t.data.result[e].date),p.includes(t.data.result[e].time)||p.push(t.data.result[e].time));m.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u53D6\u5F97\u6210\u529F"})};b();const o=u({name:"",member:"",time:((h=v.value[0])==null?void 0:h.time)||"",date:((V=v.value[0])==null?void 0:V.date)||""}),y=async()=>{try{console.log(o);const t=await x.post("/reserve/make",o);for(console.log(t),m.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u6210\u529F"}),r.value=!1;i.length;)i.pop();b()}catch{m.notify({color:"red-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u5931\u6557\uFF0C\u8ACB\u9078\u64C7\u5176\u4ED6\u6642\u9593"})}},C=[{name:"date",required:!0,label:"\u65E5\u671F",align:"center",field:t=>t.date,format:t=>`${t}`,sortable:!0},{name:"time",align:"center",label:"\u6642\u9593",field:"time",sortable:!0},{name:"member",align:"center",label:"\u5269\u9918",field:"member",sortable:!0}],i=u([]);return(t,e)=>(B(),R(D,null,[d("section",F,[l(q,{title:"\u53EF\u4F9B\u9810\u7D04\u6642\u9593",rows:i,columns:C,"row-key":"id"},null,8,["rows"])]),d("div",S,[T,l(k,{modelValue:r.value,"onUpdate:modelValue":e[4]||(e[4]=s=>r.value=s),persistent:""},{default:a(()=>[l($,{style:{"min-width":"400px"}},{default:a(()=>[l(n,null,{default:a(()=>[j]),_:1}),l(n,{class:"q-pt-none"},{default:a(()=>[l(w,{outlined:"",modelValue:o.name,"onUpdate:modelValue":e[0]||(e[0]=s=>o.name=s),placeholder:"\u59D3\u540D",hint:"\u59D3\u540D",dense:g.value},null,8,["modelValue","dense"])]),_:1}),l(n,null,{default:a(()=>[z]),_:1}),l(n,{class:"q-pt-none"},{default:a(()=>[l(w,{outlined:"",modelValue:o.member,"onUpdate:modelValue":e[1]||(e[1]=s=>o.member=s),placeholder:"\u4EBA\u6578",hint:"\u4EBA\u6578",dense:g.value},null,8,["modelValue","dense"])]),_:1}),l(n,null,{default:a(()=>[E]),_:1}),l(n,{class:"q-pt-none"},{default:a(()=>[l(Q,{modelValue:o.date,"onUpdate:modelValue":e[2]||(e[2]=s=>o.date=s),options:c,label:"\u65E5\u671F",loading:t.loading},null,8,["modelValue","options","loading"])]),_:1}),l(n,null,{default:a(()=>[I]),_:1}),l(n,{class:"q-pt-none"},{default:a(()=>[l(Q,{modelValue:o.time,"onUpdate:modelValue":e[3]||(e[3]=s=>o.time=s),options:p,label:"\u6642\u9593",loading:t.loading},null,8,["modelValue","options","loading"])]),_:1}),l(P,{align:"right",class:"text-white"},{default:a(()=>[N(l(_,{flat:"",label:"\u53D6\u6D88",color:"secondary"},null,512),[[A]]),l(_,{onClick:y,label:"\u9810\u7D04",color:"teal"})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(_,{label:"\u6211\u8981\u9810\u7D04",color:"primary",onClick:e[5]||(e[5]=s=>r.value=!0)})])],64))}};export{Z as default};
