import{Q as U,d as B}from"./QTable.467684ee.js";import{Q as n}from"./QCardSection.936b2c95.js";import{Q as i}from"./QInput.db6556ad.js";import{aS as D,aR as R,r as _,s as p,t as v,v as y,x as d,d as t,y as o,aW as w,D as N,F as P,aX as Q,aM as S,Q as h}from"./index.de8cf485.js";import{Q as A,C as F}from"./ClosePopup.56db0ccc.js";import{Q as T}from"./QCard.5ac78a81.js";import"./use-key-composition.09f48e6b.js";import"./QCheckbox.ba2b73e8.js";const $={class:"q-pa-md text-center"},E={class:"q-pa-md text-center"},I=d("h4",{class:""},"\u6211\u8981\u9810\u7D04",-1),M=d("div",{class:"text-h6"},"\u59D3\u540D",-1),O=d("div",{class:"text-h6"},"\u4EBA\u6578",-1),W=d("div",{class:"text-h6"},"\u624B\u6A5F",-1),X=d("div",{class:"text-h6"},"\u65E5\u671F",-1),j=d("div",{class:"text-h6"},"\u6642\u9593",-1),z={key:0,class:"text-h6"},le={__name:"ReservePage",setup(G){const g=D(),f=R(),m=_(!1),u=_(!1),r=_([]),V=p([]),b=p([]),x=async()=>{const l=await Q.get("/reserve");let e=0;for(e=0;e<l.data.result.length;e++)l.data.result[e].member<=0||(c.push({date:l.data.result[e].date,time:l.data.result[e].time,member:l.data.result[e].member,id:l.data.result[e]._id}),V.includes(l.data.result[e].date)||V.push(l.data.result[e].date),b.includes(l.data.result[e].time)||b.push(l.data.result[e].time));f.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u53D6\u5F97\u6210\u529F"})};x();const C=()=>{s.time=r.value[0].time,s.date=r.value[0].date,s.phone=g.phone,s.name=g.name,m.value=!0},s=p({name:"",member:"",time:"",date:"",phone:""}),k=async()=>{try{console.log(s);const l=await Q.post("/reserve/make",s);for(console.log(l),f.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u6210\u529F"}),m.value=!1;c.length;)c.pop();x()}catch{f.notify({color:"red-4",textColor:"white",icon:"cloud_done",message:"\u9810\u7D04\u5931\u6557\uFF0C\u8ACB\u9078\u64C7\u5176\u4ED6\u6642\u9593"})}},q=[{name:"date",required:!0,label:"\u65E5\u671F",align:"center",field:l=>l.date,format:l=>`${l}`,sortable:!0},{name:"time",align:"center",label:"\u6642\u9593",field:"time",sortable:!0},{name:"member",align:"center",label:"\u5269\u9918",field:"member",sortable:!0}],c=p([]);return(l,e)=>(v(),y(P,null,[d("section",$,[t(U,{title:"\u53EF\u4F9B\u9810\u7D04\u6642\u9593",rows:c,columns:q,"row-key":"id",selection:"single",selected:r.value,"onUpdate:selected":e[0]||(e[0]=a=>r.value=a)},null,8,["rows","selected"])]),d("div",E,[I,t(B,{modelValue:m.value,"onUpdate:modelValue":e[6]||(e[6]=a=>m.value=a),persistent:""},{default:o(()=>[t(T,{style:{"min-width":"400px"}},{default:o(()=>[t(n,null,{default:o(()=>[M]),_:1}),t(n,{class:"q-pt-none"},{default:o(()=>[t(i,{outlined:"",modelValue:s.name,"onUpdate:modelValue":e[1]||(e[1]=a=>s.name=a),placeholder:"\u59D3\u540D",hint:"\u59D3\u540D",dense:u.value,rules:[a=>a&&a.length>1||"\u8ACB\u8F38\u5165\u4E8C\u5B57\u4EE5\u4E0A"]},null,8,["modelValue","dense","rules"])]),_:1}),t(n,null,{default:o(()=>[O]),_:1}),t(n,{class:"q-pt-none"},{default:o(()=>[t(i,{outlined:"",modelValue:s.member,"onUpdate:modelValue":e[2]||(e[2]=a=>s.member=a),placeholder:"\u4EBA\u6578",hint:"\u4EBA\u6578",dense:u.value,rules:[a=>a>=1||"\u6700\u5C11\u9700\u9810\u7D041\u4F4D"]},null,8,["modelValue","dense","rules"])]),_:1}),t(n,null,{default:o(()=>[W]),_:1}),t(n,{class:"q-pt-none"},{default:o(()=>[t(i,{outlined:"",modelValue:s.phone,"onUpdate:modelValue":e[3]||(e[3]=a=>s.phone=a),dense:u.value},null,8,["modelValue","dense"])]),_:1}),t(n,null,{default:o(()=>[X]),_:1}),t(n,{class:"q-pt-none"},{default:o(()=>[t(i,{outlined:"",modelValue:s.date,"onUpdate:modelValue":e[4]||(e[4]=a=>s.date=a),dense:u.value,readonly:""},null,8,["modelValue","dense"])]),_:1}),t(n,null,{default:o(()=>[j]),_:1}),t(n,{class:"q-pt-none"},{default:o(()=>[t(i,{outlined:"",modelValue:s.time,"onUpdate:modelValue":e[5]||(e[5]=a=>s.time=a),dense:u.value,readonly:""},null,8,["modelValue","dense"])]),_:1}),t(A,{align:"right",class:"text-white"},{default:o(()=>[S(t(h,{flat:"",label:"\u53D6\u6D88",color:"secondary"},null,512),[[F]]),t(h,{onClick:k,label:"\u9810\u7D04",color:"teal"})]),_:1})]),_:1})]),_:1},8,["modelValue"]),r.value[0]?w("",!0):(v(),y("div",z,"\u8ACB\u5148\u9078\u64C7\u60F3\u9810\u7D04\u7684\u6642\u9593")),r.value[0]?(v(),N(h,{key:1,label:"\u6211\u8981\u9810\u7D04",color:"primary",onClick:C})):w("",!0)])],64))}};export{le as default};
