import{Q as F}from"./QImg.8b4386c9.js";import{Q as $}from"./QTd.2ca7f72d.js";import{Q as N,d as j,e as D}from"./QTable.66be56f5.js";import{aR as I,r as y,s as w,t as f,v as x,x as i,f as t,y as n,D as V,aW as h,Q as c,F as S,aX as m,aM as b}from"./index.28386664.js";import{Q as p}from"./QInput.a1411147.js";import{Q as d}from"./QCardSection.65fba01d.js";import{Q as T}from"./QCardActions.fd5c7caa.js";import{Q as E}from"./QCard.e1264f17.js";import{C}from"./ClosePopup.f726989a.js";import{u as M}from"./vue-i18n.runtime.esm-bundler.6a1ae5c0.js";import"./use-key-composition.10644b8a.js";import"./QCheckbox.ff9b47af.js";const O={id:"useradmin"},P={class:"q-pa-md text-center"},R={class:"q-pa-md text-center column row-xs justify-center"},W={key:0,class:"q-pa-md text-center column row-xs"},X={key:1,class:"q-pa-md text-center column row-xs justify-center"},z={class:"row justify-center"},G=i("div",{class:"text-h6"},"id",-1),H=i("div",{class:"text-h6"},"\u540D\u5B57",-1),J=i("div",{class:"text-h6"},"\u5E33\u865F",-1),K=i("div",{class:"text-h6"},"\u624B\u6A5F",-1),L=i("div",{class:"text-h6"},"\u6B0A\u9650:\u7BA1\u7406\u54E1:1 \u4F7F\u7528\u8005:0",-1),ce={__name:"UserAdmin",setup(Y){const{t:g}=M(),u=I(),l=y([]),Q=["\u540D\u5B57","\u5E33\u865F","\u96FB\u8A71"],v=y(!1),q=[{name:"image",label:g("image"),align:"left"},{name:"id",required:!0,label:"id",align:"left",field:"id",sortable:!0},{name:"account",align:"left",label:g("account"),field:"account",sortable:!0},{name:"name",align:"left",label:g("name"),field:"name",sortable:!0},{name:"phone",align:"left",label:g("phone"),field:"phone",sortable:!0},{name:"role",align:"left",label:g("role"),field:"role",sortable:!0}];function k(){v.value=!0}const s=w([]),_=async()=>{const o=await m.get("/users/all");s.splice(0,s.length);let e=0;for(e=0;e<o.data.result.data.length;e++)s.push({id:o.data.result.data[e]._id,account:o.data.result.data[e].account,name:o.data.result.data[e].name,phone:o.data.result.data[e].phone,role:o.data.result.data[e].role});u.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u6703\u54E1\u53D6\u5F97\u6210\u529F"})};_();const r=w({search:"",select:""}),U=async()=>{var o;try{if(console.log(r),r.select==="\u540D\u5B57"){const e=await m.post("users/search/name",r);s.splice(0,s.length);let a=0;for(a=0;a<=e.data.message.length;a++)s.push({id:e.data.message[a]._id,account:e.data.message[a].account,name:e.data.message[a].name,phone:e.data.message[a].phone,role:e.data.message[a].role});u.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u641C\u5C0B\u6210\u529F"})}else if(r.select==="\u5E33\u865F"){const e=await m.post("users/search/account",r);s.splice(0,s.length);let a=0;for(a=0;a<=e.data.message.length;a++)s.push({id:e.data.message[a]._id,account:e.data.message[a].account,name:e.data.message[a].name,phone:e.data.message[a].phone,role:e.data.message[a].role});u.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u641C\u5C0B\u6210\u529F"})}else if(r.select==="\u96FB\u8A71"){const e=await m.post("users/search/phone",r);s.splice(0,s.length),console.log(e.data.message);let a=0;for(a=0;a<=e.data.message.length;a++)s.push({id:(o=e.data.message[a])==null?void 0:o._id,account:e.data.message[a].account,name:e.data.message[a].name,phone:e.data.message[a].phone,role:e.data.message[a].role})}u.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u641C\u5C0B\u6210\u529F"})}catch(e){console.log(e)}},A=async()=>{try{const o=await m.delete(`/users/${l.value[0].id}`);for(console.log(o),u.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u522A\u9664\u6210\u529F"});s.length;)s.pop();_()}catch{u.notify({color:"red-4",textColor:"white",icon:"cloud_done",message:"\u522A\u9664\u5931\u6557"})}},B=async()=>{try{console.log(l==null?void 0:l.value[0]),await m.patch(`/users/admin/${l==null?void 0:l.value[0].id}`,l.value[0]),await u.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u4FEE\u6539\u6210\u529F"})}catch(o){u.notify({color:"red-4",textColor:"white",icon:"info",message:o.message})}};return(o,e)=>(f(),x(S,null,[i("section",O,[i("div",P,[t(N,{title:o.$t("useradmin"),rows:s,columns:q,"row-key":"name",selection:"single",selected:l.value,"onUpdate:selected":e[0]||(e[0]=a=>l.value=a)},{"body-cell-image":n(a=>[t($,{style:{width:"10px"}},{default:n(()=>[t(F,{src:`https://source.boringavatars.com/beam/${a.row.account}?colors=53C2BA,C0538A,F4C752,060614,F5F5F4`,height:"70px",width:"70px"},null,8,["src"])]),_:2},1024)]),_:1},8,["title","rows","selected"])]),i("div",R,[l.value[0]?(f(),V(c,{key:0,icon:"edit",label:"\u4FEE\u6539",onClick:k,class:"q-ma-xl",color:"teal"})):h("",!0),l.value[0]?(f(),V(c,{key:1,icon:"delete",label:"\u522A\u9664",onClick:A,class:"q-ma-xl",color:"teal"})):h("",!0)]),l.value[0]?h("",!0):(f(),x("div",W,[t(p,{outlined:"",modelValue:r.search,"onUpdate:modelValue":e[1]||(e[1]=a=>r.search=a),label:"\u641C\u5C0B","stack-label":"",style:{margin:"auto",width:"400px","margin-bottom":"32px"}},null,8,["modelValue"])])),l.value[0]?h("",!0):(f(),x("div",X,[t(c,{icon:"search",label:"\u641C\u5C0B",onClick:U,class:"q-mr-md-xl q-my-md",color:"primary"}),t(j,{outlined:"",modelValue:r.select,"onUpdate:modelValue":e[2]||(e[2]=a=>r.select=a),options:Q,label:"\u641C\u5C0B\u985E\u5225",id:"option"},null,8,["modelValue"])])),i("div",z,[t(c,{icon:"reply",label:"\u8FD4\u56DE",class:"q-mt-xl",onClick:_,color:"teal"})])]),t(D,{modelValue:v.value,"onUpdate:modelValue":e[8]||(e[8]=a=>v.value=a),persistent:""},{default:n(()=>[t(E,{style:{width:"400px"}},{default:n(()=>[t(d,null,{default:n(()=>[G]),_:1}),t(d,{class:"q-pt-none"},{default:n(()=>[t(p,{outline:"",modelValue:l.value[0].id,"onUpdate:modelValue":e[3]||(e[3]=a=>l.value[0].id=a),readonly:""},null,8,["modelValue"])]),_:1}),t(d,null,{default:n(()=>[H]),_:1}),t(d,{class:"q-pt-none"},{default:n(()=>[t(p,{outline:"",modelValue:l.value[0].name,"onUpdate:modelValue":e[4]||(e[4]=a=>l.value[0].name=a)},null,8,["modelValue"])]),_:1}),t(d,null,{default:n(()=>[J]),_:1}),t(d,{class:"q-pt-none"},{default:n(()=>[t(p,{outline:"",modelValue:l.value[0].account,"onUpdate:modelValue":e[5]||(e[5]=a=>l.value[0].account=a)},null,8,["modelValue"])]),_:1}),t(d,null,{default:n(()=>[K]),_:1}),t(d,{class:"q-pt-none"},{default:n(()=>[t(p,{outline:"",modelValue:l.value[0].phone,"onUpdate:modelValue":e[6]||(e[6]=a=>l.value[0].phone=a)},null,8,["modelValue"])]),_:1}),t(d,null,{default:n(()=>[L]),_:1}),t(d,{class:"q-pt-none"},{default:n(()=>[t(p,{outline:"",modelValue:l.value[0].role,"onUpdate:modelValue":e[7]||(e[7]=a=>l.value[0].role=a)},null,8,["modelValue"])]),_:1}),t(T,{align:"right",class:"text-primary"},{default:n(()=>[b(t(c,{flat:"",label:"\u53D6\u6D88"},null,512),[[C]]),b(t(c,{flat:"",label:"\u66F4\u6539",onClick:B},null,512),[[C]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{ce as default};
