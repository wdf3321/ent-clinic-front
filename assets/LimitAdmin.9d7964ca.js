import{Q as K,d as Q}from"./QTable.467684ee.js";import{r as g,aR as L,s as C,t as k,v as N,x as s,d as e,Q as r,aM as u,D as P,aW as F,y as l,F as I,aX as x,L as _,b5 as q}from"./index.de8cf485.js";import{Q as n}from"./QCardSection.936b2c95.js";import{Q as v,a as h,b as U}from"./QTime.8d855664.js";import{Q as f}from"./QInput.db6556ad.js";import{Q as D,C as m}from"./ClosePopup.56db0ccc.js";import{Q as $}from"./QCard.5ac78a81.js";import"./use-key-composition.09f48e6b.js";import"./QCheckbox.ba2b73e8.js";import"./use-cache.b0833c75.js";const R={class:"q-pa-md"},T={class:"text-center",id:"btns"},W=s("div",{class:"text-h6"},"\u65E5\u671F",-1),E={class:"row items-center justify-end"},M=s("div",{class:"text-h6"},"\u6642\u9593",-1),X={class:"row items-center justify-end"},z=s("div",{class:"text-h6"},"\u4EBA\u6578",-1),G=s("div",{class:"text-h6"},"\u958B\u59CB\u65E5\u671F",-1),H={class:"row items-center justify-end"},J=s("div",{class:"text-h6"},"\u7D50\u675F\u65E5\u671F",-1),O={class:"row items-center justify-end"},Y=s("div",{class:"text-h6"},"\u4EBA\u6578",-1),Z=s("div",{class:"text-h6"},"\u6642\u9593",-1),ee={class:"row items-center justify-end"},ce={__name:"LimitAdmin",setup(te){const y=g(!1),V=g(!1),p=L(),i=C({date:"",time:"",member:""}),d=C({startDate:"",endDate:"",time:"",member:""}),c=C([]),b=g([]),w=async()=>{const o=await x.get("/reserve");console.log(o.data.result);let t=0;for(t=0;t<o.data.result.length;t++)o.data.result[t].member!==0&&c.push({date:o.data.result[t].date,time:o.data.result[t].time,member:o.data.result[t].member,id:o.data.result[t]._id});p.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u53EF\u9810\u7D04\u53D6\u5F97\u6210\u529F"})};w();const j=async()=>{const o=await x.post("/reserve/",i);for(console.log(o),p.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u65B0\u589E\u6210\u529F"});c.length;)c.pop();w()},B=async()=>{try{const o=await x.post("/reserve/week",d);for(console.log(o),p.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u65B0\u589E\u6210\u529F"});c.length;)c.pop();w()}catch{p.notify({color:"red-4",textColor:"white",icon:"cloud_done",message:"\u65B0\u589E\u6210\u529F"})}},A=async()=>{try{const o=await x.delete(`/reserve/${b.value[0].id}`);for(console.log(o),p.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u522A\u9664\u6210\u529F"});c.length;)c.pop();w()}catch{p.notify({color:"red-4",textColor:"white",icon:"cloud_off",message:"\u8ACB\u9078\u64C7\u8981\u522A\u9664\u7684\u9805\u76EE"})}},S=[{name:"id",align:"center",label:"id",field:"id",sortable:!0},{name:"date",required:!0,label:"\u65E5\u671F",align:"left",field:o=>o.date,format:o=>`${o}`,sortable:!0},{name:"time",align:"center",label:"\u6642\u9593",field:"time",sortable:!0},{name:"member",label:"\u53EF\u9810\u7D04\u4EBA\u6578",field:"member",sortable:!0}];return(o,t)=>(k(),N(I,null,[s("section",null,[s("div",R,[e(K,{title:"\u53EF\u9810\u7D04\u4EBA\u6578\u7BA1\u7406",rows:c,columns:S,"row-key":"id",selection:"single",selected:b.value,"onUpdate:selected":t[0]||(t[0]=a=>b.value=a)},null,8,["rows","selected"])])]),s("section",null,[s("div",T,[e(r,{icon:"add",label:"\u65B0\u589E\u4E00\u5929",color:"primary",onClick:t[1]||(t[1]=a=>y.value=!0),class:"q-mr-md-xl q-my-xs-xs"}),e(r,{icon:"add_box",label:"\u65B0\u589E\u591A\u5929",color:"primary",onClick:t[2]||(t[2]=a=>V.value=!0),class:"q-mr-md-xl q-my-xs-xs"}),b.value[0]?u((k(),P(r,{key:0,color:"teal",label:"\u522A\u9664\u9078\u64C7",icon:"delete",onClick:A,class:"q-mr-md-xl q-my-xs-xs"},null,512)),[[m]]):F("",!0)])]),e(Q,{modelValue:y.value,"onUpdate:modelValue":t[9]||(t[9]=a=>y.value=a),persistent:""},{default:l(()=>[e($,{style:{"min-width":"400px"}},{default:l(()=>[e(n,null,{default:l(()=>[W]),_:1}),e(n,{class:"q-pt-none"},{default:l(()=>[e(f,{filled:"",modelValue:i.date,"onUpdate:modelValue":t[4]||(t[4]=a=>i.date=a),mask:"date",rules:["date"]},{append:l(()=>[e(_,{name:"calendar_today",class:"cursor-pointer"},{default:l(()=>[e(v,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(h,{modelValue:i.date,"onUpdate:modelValue":t[3]||(t[3]=a=>i.date=a),"today-btn":""},{default:l(()=>[s("div",E,[u(e(r,{label:"Close",color:"primary",flat:""},null,512),[[m]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(n,null,{default:l(()=>[M]),_:1}),e(n,{class:"q-pt-none"},{default:l(()=>[e(f,{filled:"",modelValue:i.time,"onUpdate:modelValue":t[6]||(t[6]=a=>i.time=a),mask:"time",rules:["time"]},{append:l(()=>[e(_,{name:"access_time",class:"cursor-pointer"},{default:l(()=>[e(v,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(U,{modelValue:i.time,"onUpdate:modelValue":t[5]||(t[5]=a=>i.time=a),"now-btn":""},{default:l(()=>[s("div",X,[u(e(r,{label:"Close",color:"primary",flat:""},null,512),[[m]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(n,null,{default:l(()=>[z]),_:1}),e(n,{class:"q-pt-none"},{default:l(()=>[e(f,{dense:"",modelValue:i.member,"onUpdate:modelValue":t[7]||(t[7]=a=>i.member=a),autofocus:"",onKeyup:t[8]||(t[8]=q(a=>y.value=!1,["enter"]))},null,8,["modelValue"])]),_:1}),e(D,{align:"right",class:"text-white"},{default:l(()=>[u(e(r,{flat:"",color:"secondary",label:"\u53D6\u6D88"},null,512),[[m]]),u(e(r,{color:"teal",label:"\u65B0\u589E",onClick:j},null,512),[[m]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Q,{modelValue:V.value,"onUpdate:modelValue":t[18]||(t[18]=a=>V.value=a),persistent:""},{default:l(()=>[e($,{style:{"min-width":"400px"}},{default:l(()=>[e(n,null,{default:l(()=>[G]),_:1}),e(n,{class:"q-pt-none"},{default:l(()=>[e(f,{filled:"",modelValue:d.startDate,"onUpdate:modelValue":t[11]||(t[11]=a=>d.startDate=a),mask:"date",rules:["date"]},{append:l(()=>[e(_,{name:"calendar_today",class:"cursor-pointer"},{default:l(()=>[e(v,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(h,{modelValue:d.startDate,"onUpdate:modelValue":t[10]||(t[10]=a=>d.startDate=a),"today-btn":""},{default:l(()=>[s("div",H,[u(e(r,{label:"Close",color:"primary",flat:""},null,512),[[m]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(n,null,{default:l(()=>[J]),_:1}),e(n,{class:"q-pt-none"},{default:l(()=>[e(f,{filled:"",modelValue:d.endDate,"onUpdate:modelValue":t[13]||(t[13]=a=>d.endDate=a),mask:"date",rules:["date"]},{append:l(()=>[e(_,{name:"calendar_today",class:"cursor-pointer"},{default:l(()=>[e(v,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(h,{modelValue:d.endDate,"onUpdate:modelValue":t[12]||(t[12]=a=>d.endDate=a),"today-btn":""},{default:l(()=>[s("div",O,[u(e(r,{label:"Close",color:"primary",flat:""},null,512),[[m]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(n,null,{default:l(()=>[Y]),_:1}),e(n,{class:"q-pt-none"},{default:l(()=>[e(f,{dense:"",modelValue:d.member,"onUpdate:modelValue":t[14]||(t[14]=a=>d.member=a),autofocus:"",onKeyup:t[15]||(t[15]=q(a=>V.value=!1,["enter"]))},null,8,["modelValue"])]),_:1}),e(n,null,{default:l(()=>[Z]),_:1}),e(n,{class:"q-pt-none"},{default:l(()=>[e(f,{filled:"",modelValue:d.time,"onUpdate:modelValue":t[17]||(t[17]=a=>d.time=a),mask:"time",rules:["time"]},{append:l(()=>[e(_,{name:"access_time",class:"cursor-pointer"},{default:l(()=>[e(v,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(U,{modelValue:d.time,"onUpdate:modelValue":t[16]||(t[16]=a=>d.time=a),"now-btn":""},{default:l(()=>[s("div",ee,[u(e(r,{label:"Close",color:"primary",flat:""},null,512),[[m]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(D,{align:"right",class:"text-white"},{default:l(()=>[u(e(r,{flat:"",color:"secondary",label:"\u53D6\u6D88"},null,512),[[m]]),u(e(r,{color:"teal",label:"\u65B0\u589E",onClick:B},null,512),[[m]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{ce as default};
