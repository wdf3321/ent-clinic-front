import{Q as I}from"./QImg.5f2d0fc5.js";import{Q as N}from"./QTd.8e3bb6bd.js";import{Q as j,d as S,e as D}from"./QTable.f74a1eef.js";import{v as T,r as y,x as w,y as h,z as x,A as i,f as a,B as n,H as V,b5 as m,Q as p,I as v,F as z,b6 as g,aS as C}from"./index.09be9134.js";import{Q as f}from"./QInput.ec715d8b.js";import{Q as u}from"./QCardSection.a8f2e322.js";import{Q as E,C as Q}from"./ClosePopup.15a8bfe8.js";import{Q as H}from"./QCard.4745da73.js";import{u as O}from"./vue-i18n.runtime.esm-bundler.e93b5c55.js";import"./use-key-composition.768c978b.js";import"./QCheckbox.329922fb.js";const P={id:"useradmin"},G={class:"q-pa-md text-center"},J={class:"q-pa-md text-center column row-xs justify-center"},K={key:0,class:"q-pa-md text-center column row-xs"},L={key:1,class:"q-pa-md text-center column row-xs justify-center"},M={class:"row justify-center"},R=i("div",{class:"text-h6"},"id",-1),W=i("div",{class:"text-h6"},"\u540D\u5B57",-1),X=i("div",{class:"text-h6"},"\u5E33\u865F",-1),Y=i("div",{class:"text-h6"},"\u624B\u6A5F",-1),Z=i("div",{class:"text-h6"},"\u6B0A\u9650:\u7BA1\u7406\u54E1:1 \u4F7F\u7528\u8005:0",-1),me={__name:"UserAdmin",setup(ee){const{t:d}=O(),c=T(),t=y([]),q=["\u540D\u5B57","\u5E33\u865F","\u96FB\u8A71"],_=y(!1),k=[{name:"image",label:d("image"),align:"left"},{name:"id",required:!0,label:"id",align:"left",field:"id",sortable:!0},{name:"account",align:"left",label:d("account"),field:"account",sortable:!0},{name:"name",align:"left",label:d("name"),field:"name",sortable:!0},{name:"phone",align:"left",label:d("phone"),field:"phone",sortable:!0},{name:"role",align:"left",label:d("role"),field:"role",sortable:!0}];function U(){_.value=!0}const s=w([]),b=async()=>{const o=await g.get("/users/all");s.splice(0,s.length);let e=0;for(e=0;e<o.data.result.data.length;e++)s.push({id:o.data.result.data[e]._id,account:o.data.result.data[e].account,name:o.data.result.data[e].name,phone:o.data.result.data[e].phone,role:o.data.result.data[e].role});c.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u6703\u54E1\u53D6\u5F97\u6210\u529F"})};b();const r=w({search:"",select:""}),A=async()=>{var o;try{if(console.log(r),r.select==="\u540D\u5B57"){const e=await g.post("users/search/name",r);s.splice(0,s.length);let l=0;for(l=0;l<=e.data.message.length;l++)s.push({id:e.data.message[l]._id,account:e.data.message[l].account,name:e.data.message[l].name,phone:e.data.message[l].phone,role:e.data.message[l].role});c.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u641C\u5C0B\u6210\u529F"})}else if(r.select==="\u5E33\u865F"){const e=await g.post("users/search/account",r);s.splice(0,s.length);let l=0;for(l=0;l<=e.data.message.length;l++)s.push({id:e.data.message[l]._id,account:e.data.message[l].account,name:e.data.message[l].name,phone:e.data.message[l].phone,role:e.data.message[l].role});c.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u641C\u5C0B\u6210\u529F"})}else if(r.select==="\u96FB\u8A71"){const e=await g.post("users/search/phone",r);s.splice(0,s.length),console.log(e.data.message);let l=0;for(l=0;l<=e.data.message.length;l++)s.push({id:(o=e.data.message[l])==null?void 0:o._id,account:e.data.message[l].account,name:e.data.message[l].name,phone:e.data.message[l].phone,role:e.data.message[l].role})}c.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u641C\u5C0B\u6210\u529F"})}catch(e){console.log(e)}},B=async()=>{try{const o=await g.delete(`/users/${t.value[0].id}`);for(console.log(o),c.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u522A\u9664\u6210\u529F"});s.length;)s.pop();b()}catch{c.notify({color:"red-4",textColor:"white",icon:"cloud_done",message:"\u522A\u9664\u5931\u6557"})}},F=async()=>{try{console.log(t==null?void 0:t.value[0]),await g.patch(`/users/admin/${t==null?void 0:t.value[0].id}`,t.value[0]),await c.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u4FEE\u6539\u6210\u529F"})}catch(o){c.notify({color:"red-4",textColor:"white",icon:"info",message:o.message})}},$=()=>{t.value=[],r.search="",b()};return(o,e)=>(h(),x(z,null,[i("section",P,[i("div",G,[a(j,{title:o.$t("useradmin"),rows:s,columns:k,"row-key":"name",selection:"single",selected:t.value,"onUpdate:selected":e[0]||(e[0]=l=>t.value=l)},{"body-cell-image":n(l=>[a(N,{style:{width:"10px"}},{default:n(()=>[a(I,{src:`https://source.boringavatars.com/beam/${l.row.account}?colors=53C2BA,C0538A,F4C752,060614,F5F5F4`,height:"70px",width:"70px"},null,8,["src"])]),_:2},1024)]),_:1},8,["title","rows","selected"])]),i("div",J,[t.value[0]?(h(),V(p,{key:0,icon:"edit",label:m(d)("edit"),onClick:U,class:"q-ma-xl",color:"teal"},null,8,["label"])):v("",!0),t.value[0]?(h(),V(p,{key:1,icon:"delete",label:m(d)("delete"),onClick:B,class:"q-ma-xl",color:"teal"},null,8,["label"])):v("",!0)]),t.value[0]?v("",!0):(h(),x("div",K,[a(f,{outlined:"",modelValue:r.search,"onUpdate:modelValue":e[1]||(e[1]=l=>r.search=l),label:m(d)("search"),"stack-label":"",style:{margin:"auto",width:"400px","margin-bottom":"8px"}},null,8,["modelValue","label"])])),t.value[0]?v("",!0):(h(),x("div",L,[a(p,{icon:"search",label:m(d)("search"),onClick:A,class:"q-mr-md-xl q-my-md",color:"primary"},null,8,["label"]),a(S,{outlined:"",modelValue:r.select,"onUpdate:modelValue":e[2]||(e[2]=l=>r.select=l),options:q,label:m(d)("searchtype"),id:"option"},null,8,["modelValue","label"])])),i("div",M,[a(p,{icon:"reply",label:m(d)("back"),class:"q-mt-xs",onClick:$,color:"teal"},null,8,["label"])])]),a(D,{modelValue:_.value,"onUpdate:modelValue":e[8]||(e[8]=l=>_.value=l),persistent:""},{default:n(()=>[a(H,{style:{width:"400px"}},{default:n(()=>[a(u,null,{default:n(()=>[R]),_:1}),a(u,{class:"q-pt-none"},{default:n(()=>[a(f,{outline:"",modelValue:t.value[0].id,"onUpdate:modelValue":e[3]||(e[3]=l=>t.value[0].id=l),readonly:""},null,8,["modelValue"])]),_:1}),a(u,null,{default:n(()=>[W]),_:1}),a(u,{class:"q-pt-none"},{default:n(()=>[a(f,{outline:"",modelValue:t.value[0].name,"onUpdate:modelValue":e[4]||(e[4]=l=>t.value[0].name=l)},null,8,["modelValue"])]),_:1}),a(u,null,{default:n(()=>[X]),_:1}),a(u,{class:"q-pt-none"},{default:n(()=>[a(f,{outline:"",modelValue:t.value[0].account,"onUpdate:modelValue":e[5]||(e[5]=l=>t.value[0].account=l)},null,8,["modelValue"])]),_:1}),a(u,null,{default:n(()=>[Y]),_:1}),a(u,{class:"q-pt-none"},{default:n(()=>[a(f,{outline:"",modelValue:t.value[0].phone,"onUpdate:modelValue":e[6]||(e[6]=l=>t.value[0].phone=l)},null,8,["modelValue"])]),_:1}),a(u,null,{default:n(()=>[Z]),_:1}),a(u,{class:"q-pt-none"},{default:n(()=>[a(f,{outline:"",modelValue:t.value[0].role,"onUpdate:modelValue":e[7]||(e[7]=l=>t.value[0].role=l)},null,8,["modelValue"])]),_:1}),a(E,{align:"right",class:"text-primary"},{default:n(()=>[C(a(p,{flat:"",label:"\u53D6\u6D88"},null,512),[[Q]]),C(a(p,{flat:"",label:"\u66F4\u6539",onClick:F},null,512),[[Q]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{me as default};
